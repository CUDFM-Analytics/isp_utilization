NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.4 (TS1M7)
      Licensed to UNIVERSITY OF COLORADO SYSTEM - SFA - T&R, Site 70082279.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Analytical products:

      SAS/STAT 15.2
      SAS/ETS 15.2
      SAS/OR 15.2
      SAS/IML 15.2
      SAS/QC 15.2

NOTE: Additional host information:

 X64_10PRO WIN 10.0.19041  Workstation

NOTE: SAS initialization used:
      real time           3.82 seconds
      cpu time            3.32 seconds

1    %include "S:/FHPC/DATA/HCPF_Data_files_SECURE/Kim/isp/isp_utilization/02_code/00_global.sas";
NOTE: Libref OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\04_data
NOTE: Format PCTFMT has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.09 seconds
      cpu time            0.07 seconds


NOTE: Writing HTML Body file: sashtml.htm
NOTE: Overwriting existing template/link: Base.Freq.OneWayList
NOTE: TABLE 'Base.Freq.OneWayList' has been saved to: SASUSER.TEMPLAT
NOTE: PROCEDURE TEMPLATE used (Total process time):
      real time           1.29 seconds
      cpu time            0.93 seconds


NOTE: Libref DB was successfully assigned as follows:
      Engine:        ODBC
      Physical Name:
NOTE: Libref VARLEN was successfully assigned as follows:
      Engine:        V9
      Physical Name:
      \\data.ucdenver.pvt\dept\SOM\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries\DBVarLength
      s
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.68 seconds
      cpu time            1.36 seconds


NOTE: Libref BHJT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries
NOTE: Libref VARLEN was successfully assigned as follows:
      Engine:        V9
      Physical Name:
      \\data.ucdenver.pvt\dept\SOM\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries\DBVarLength
      s
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.08 seconds
      cpu time            1.09 seconds


NOTE: Libref BHJT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries
NOTE: Informat AGE_RANGE has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds



240  proc sql;
241  create table out.clm_header_1819 as
242    select ICN_NBR  length = &ICN_NBR ,
243           mcaid_id length = &mcaid_id,
244           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
245           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
246           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
247           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
248           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
249           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
250           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
251           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
252           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
253           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
254           datepart(FRST_SVC_DT)  as FRST_SVC_DT,
255           datepart(LST_SVC_DT)   as LST_SVC_DT,
256           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT,
257           clm_ctg_cd     length = &clm_ctg_cd,
258           CLM_TYP_CD     length = &CLM_TYP_CD,
259           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
260           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
261           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
262           pd_amt,
263           tpl_pd_amt
264    from  db.CLM_DIM_V
265    where CURR_REC_IND = 'Y'
266      and SRC_REC_DEL_IND = 'N'
267      and CLM_STS_CD = 'P'
268      and most_rcnt_clm_ind = 'Y'
269      and enc_ind = 'N'
270      and mcaid_id in (SELECT clnt_id
271                    FROM out.clntid_1819);
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: There were 25018669 observations read from the data set DB.CLM_DIM_V.
      WHERE (CURR_REC_IND='Y') and (SRC_REC_DEL_IND='N') and (CLM_STS_CD='P') and
      (MOST_RCNT_CLM_IND='Y') and (ENC_IND='N');
NOTE: There were 2651615 observations read from the data set OUT.CLNTID_1819.
WARNING: The data set OUT.CLM_HEADER_1819 may be incomplete.  When this step was stopped there were
         21187211 observations and 22 variables.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5:50.85
      cpu time            5:04.00


272    order by mcaid_id;
273  quit;

274  proc sql;
275  create table out.clm_header_1819 as
276    select ICN_NBR  length = &ICN_NBR ,
277           mcaid_id length = &mcaid_id,
278           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
279           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
280           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
281           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
282           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
283           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
284           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
285           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
286           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
287           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
288           datepart(FRST_SVC_DT)  as FRST_SVC_DT format=yymmddd10.,
289           datepart(LST_SVC_DT)   as LST_SVC_DT format=yymmddd10.,
290           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT format=yymmddd10.,
291           clm_ctg_cd     length = &clm_ctg_cd,
292           CLM_TYP_CD     length = &CLM_TYP_CD,
293           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
294           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
295           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
296           pd_amt,
297           tpl_pd_amt
298    from  db.CLM_DIM_V (obs = 1000)
299    where CURR_REC_IND = 'Y'
300      and SRC_REC_DEL_IND = 'N'
301      and CLM_STS_CD = 'P'
302      and most_rcnt_clm_ind = 'Y'
303      and enc_ind = 'N'
304      and mcaid_id in (SELECT clnt_id
305                    FROM out.clntid_1819);
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: Table OUT.CLM_HEADER_1819 created, with 938 rows and 22 columns.

306    order by mcaid_id;
       -----
       180
ERROR 180-322: Statement is not valid or it is used out of proper order.

307  quit;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.60 seconds
      cpu time            2.17 seconds


308
309  * claim headers 1819;
310  proc sql;
311  create table out.clm_header_1819 as
312    select ICN_NBR  length = &ICN_NBR ,
313           mcaid_id length = &mcaid_id,
314           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
315           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
316           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
317           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
318           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
319           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
320           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
321           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
322           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
323           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
324           datepart(FRST_SVC_DT)  as FRST_SVC_DT format=yymmddd10.,
325           datepart(LST_SVC_DT)   as LST_SVC_DT format=yymmddd10.,
326           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT format=yymmddd10.,
327           clm_ctg_cd     length = &clm_ctg_cd,
328           CLM_TYP_CD     length = &CLM_TYP_CD,
329           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
330           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
331           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
332           pd_amt,
333           tpl_pd_amt
334    from  db.CLM_DIM_V (obs = 1000)
335    where CURR_REC_IND = 'Y'
336      and SRC_REC_DEL_IND = 'N'
337      and CLM_STS_CD = 'P'
338      and most_rcnt_clm_ind = 'Y'
339      and enc_ind = 'N'
340      and mcaid_id in (SELECT clnt_id
341                    FROM out.clntid_1819)
342    order by mcaid_id;
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: Table OUT.CLM_HEADER_1819 created, with 938 rows and 22 columns.

343  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.54 seconds
      cpu time            1.87 seconds


344
345  proc print data = out.clm_1819;
346  var drug_dspn_dt;
347  run;

NOTE: There were 1000 observations read from the data set OUT.CLM_1819.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           1.38 seconds
      cpu time            0.39 seconds


348  proc sql;
349  create table out.clm_header_1819 as
350    select ICN_NBR  length = &ICN_NBR ,
351           mcaid_id length = &mcaid_id,
352           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
353           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
354           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
355           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
356           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
357           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
358           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
359           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
360           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
361           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
362           datepart(FRST_SVC_DT)  as FRST_SVC_DT format=yymmddd10.,
363           datepart(LST_SVC_DT)   as LST_SVC_DT format=yymmddd10.,
364           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT format=yymmddd10.,
365           clm_ctg_cd     length = &clm_ctg_cd,
366           CLM_TYP_CD     length = &CLM_TYP_CD,
367           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
368           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
369           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
370           pd_amt,
371           tpl_pd_amt
372    from  db.CLM_DIM_V
373    where CURR_REC_IND = 'Y'
374      and SRC_REC_DEL_IND = 'N'
375      and CLM_STS_CD = 'P'
376      and most_rcnt_clm_ind = 'Y'
377      and enc_ind = 'N'
378      and mcaid_id in (SELECT clnt_id
379                    FROM out.clntid_1819)
380    order by mcaid_id;
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: Table OUT.CLM_HEADER_1819 created, with 230635966 rows and 22 columns.

381  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:49:34.07
      cpu time            1:12:15.90


382  proc print data = out.clm_header_1819 (obs=100);
383  run;

NOTE: There were 100 observations read from the data set OUT.CLM_HEADER_1819.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.31 seconds
      cpu time            0.23 seconds


384
385  data out.clm_1819 (drop = SBMT_MCAID_ID);
386  set  out.clm_1819;
387  if '01Jul2018'd <= FRST_SVC_DT <= '30Jun2019'd;
388  run;

WARNING: The variable SBMT_MCAID_ID in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1000 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLM_1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           2.31 seconds
      cpu time            0.20 seconds


389  data out.clm_1819;
390  set  out.clm_1819;
391  if '01Jul2018'd <= FRST_SVC_DT <= '30Jun2019'd;
392  run;

NOTE: There were 0 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLM_1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.01 seconds


393  data out.clm_header_1819_SFY;
394  set  out.clm_header_1819;
395  if '01Jul2018'd <= FRST_SVC_DT <= '30Jun2019'd;
396  run;

NOTE: There were 230635966 observations read from the data set OUT.CLM_HEADER_1819.
NOTE: The data set OUT.CLM_HEADER_1819_SFY has 22406479 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           17:07.13
      cpu time            1:48.48


397  data out.clms_1518_grp1819 (drop = SBMT_MCAID_ID);
398  set  out.clm_1819;
399  if '01Jul2015'd <= FRST_SVC_DT <= '30Jun2018'd;
400  run;

WARNING: The variable SBMT_MCAID_ID in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLMS_1518_GRP1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds


401  data out.clms_1518_grp1819;
402  set  out.clm_1819;
403  if '01Jul2015'd <= FRST_SVC_DT <= '30Jun2018'd;
404  run;

NOTE: There were 0 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLMS_1518_GRP1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds


405  * Get claims for 2015-2019 SFY for 1819 members;
406  data out.clm_header_1518_grp1819;
407  set  out.clm_header_1819;
408  if '01Jul2015'd <= FRST_SVC_DT <= '30Jun2018'd;
409  run;

NOTE: There were 230635966 observations read from the data set OUT.CLM_HEADER_1819.
NOTE: The data set OUT.CLM_HEADER_1518_GRP1819 has 68458900 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           19:56.03
      cpu time            2:17.81


410
411  proc print data = out.clm_header_1819_SFY (obs=100);
412  run;

NOTE: There were 100 observations read from the data set OUT.CLM_HEADER_1819_SFY.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.29 seconds
      cpu time            0.21 seconds


413  data out.clm_header_1519_group1;
414  set  out.clm_header_1819_SFY
415       out.clm_header_1518_grp1819;
416  run;

NOTE: There were 22406479 observations read from the data set OUT.CLM_HEADER_1819_SFY.
NOTE: There were 68458900 observations read from the data set OUT.CLM_HEADER_1518_GRP1819.
NOTE: The data set OUT.CLM_HEADER_1519_GROUP1 has 90865379 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           12:06.75
      cpu time            1:43.40


417  proc sort data = out.clm_header_1519_group1 (keep=ICN_NBR) out=out.icns_group1_1519 nodupkey;
418  by ICN_NBR;
419  run;

NOTE: There were 90865379 observations read from the data set OUT.CLM_HEADER_1519_GROUP1.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set OUT.ICNS_GROUP1_1519 has 90865379 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           7:45.59
      cpu time            2:55.35


420
421  data MyIcnFmt;
422     set out.icns_group1_1519 (keep = ICN_NBR);
423
424     retain hlo " ";
425     fmtname = "$MyIcns" ;
426     type    = "c" ;
427     start   = ICN_NBR;
428     label   = 'KEEP';
429     output ;
430     if eof then do ;
431        start = " " ;
432        label = " " ;
433        hlo   = "o" ;
434        output ;
435     end ;
436  run;

NOTE: Variable eof is uninitialized.
NOTE: There were 90865379 observations read from the data set OUT.ICNS_GROUP1_1519.
NOTE: The data set WORK.MYICNFMT has 90865379 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           1:31.36
      cpu time            1:20.39


437
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           23.35 seconds
      cpu time            23.32 seconds

ERROR: Memory capacity exceeded after 9639087 ranges and 9639086 labels.
NOTE: The SAS System stopped processing this step because of insufficient memory.
ERROR: The SAS System stopped processing this step because of insufficient memory.
NOTE: There were 9639087 observations read from the data set WORK.MYICNFMT.
438  proc format cntlin = MyIcnFmt;
439  run;
440
441  * diagnoses ;


442  proc sql;
443  create table OUT.diagTable_1519 as
444    select distinct
445           a.ICN_NBR length = &ICN_NBR,
446           a.DIAG_PRSNT_ON_ADMSN_CD  length = &DIAG_PRSNT_ON_ADMSN_CD,
447           a.DIAG_CD length = &DIAG_CD,
448           a.DIAG_DESC length = &DIAG_DESC,
449           a.CD_SET_CD length = &CD_SET_CD,
450           a.CD_SET_VER_NBR length = &CD_SET_VER_NBR,
451           a.DIAG_SEQ_CD length = &DIAG_SEQ_CD,
452           a.DIAG_SEQ_DESC length = &DIAG_SEQ_DESC
453    from db.CLM_DIAG_FACT_V as a
454    where a.CURR_REC_IND = 'Y'
455      and a.SRC_REC_DEL_IND = 'N'
456      and put(ICN_NBR, $MyIcns. ) = "KEEP"
457  ;
NOTE: Table OUT.DIAGTABLE_1519 created, with 0 rows and 8 columns.

458  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           57:25.35
      cpu time            56:26.00


459
460  * claim lines ;
461
462  data out.clm_lines_1519;
463
464    length mcaid_id $ &mcaid_id
465           ICN_NBR $ &ICN_NBR
466           RVN_CD $ &RVN_CD
467           CLM_TYP_CD $ &CLM_TYP_CD
468           pos_cd $ &pos_cd
469           DIAG_1_CD $ &DIAG_1_CD
470           DIAG_2_CD $ &DIAG_2_CD
471           DIAG_3_CD $ &DIAG_3_CD
472           DIAG_4_CD $ &DIAG_4_CD
473           proc_cd   $ &proc_cd
474           PROC_MOD_1_CD $ &PROC_MOD_1_CD
475           PROC_MOD_2_CD  $ &PROC_MOD_2_CD
476           PROC_MOD_3_CD  $ &PROC_MOD_3_CD
477           PROC_MOD_4_CD $ &PROC_MOD_4_CD
478           ATTD_PROV_LOC_ID $ &ATTD_PROV_LOC_ID
479           BILL_PROV_MCAID_ID $ &BILL_PROV_MCAID_ID
480           BILL_PROV_NPI_ID   $ &BILL_PROV_NPI_ID
481
482           BILL_PROV_LOC_ID   $ &BILL_PROV_LOC_ID
483           REND_PROV_LOC_ID   $ &REND_PROV_LOC_ID
484           REND_PROV_MCAID_ID $ &REND_PROV_MCAID_ID
485           REND_PROV_NPI_ID   $ &REND_PROV_NPI_ID
486
487           BILL_PROV_TYP_CD   $ &BILL_PROV_TYP_CD
488           REND_PROV_TYP_CD   $ &REND_PROV_TYP_CD
489
490           FAC_PROV_LOC_ID    $ &FAC_PROV_LOC_ID
491           SUPV_PROV_LOC_ID    $ &SUPV_PROV_LOC_ID
492  ;
493
494    set db.clm_lne_fact_v ( keep = mcaid_id ICN_NBR lne_nbr LNE_FRST_SVC_DT LNE_LST_SVC_DT RVN_CD
494! CLM_TYP_CD proc_cd
495                                   BILL_PROV_MCAID_ID  BILL_PROV_NPI_ID  BILL_PROV_LOC_ID
495! REND_PROV_LOC_ID REND_PROV_MCAID_ID
496                                   REND_PROV_NPI_ID  ATTD_PROV_LOC_ID BILL_PROV_TYP_CD
496! REND_PROV_TYP_CD FAC_PROV_LOC_ID
497                                   SUPV_PROV_LOC_ID CURR_REC_IND SRC_REC_DEL_IND pos_cd CLM_STS_CD
497! lne_sts_cd enc_ind
498                                   most_rcnt_clm_ind PROC_MOD_1_CD PROC_MOD_2_CD PROC_MOD_3_CD
498! PROC_MOD_4_CD DIAG_1_CD
499                                   DIAG_2_CD DIAG_3_CD DIAG_4_CD BILL_UNT_QTY
500                           );
501    where CURR_REC_IND = 'Y'
502      and SRC_REC_DEL_IND = 'N'
503      and CLM_STS_CD = 'P'
504      and lne_sts_cd = 'P'
505      and most_rcnt_clm_ind = 'Y'
506      and enc_ind = 'N'
507      and put(ICN_NBR, $MyIcns. ) = "KEEP"
508  ;
509               /* variables to ensure the claim is valid and paid: conditioned on in the where
509! statement */
510    drop   CURR_REC_IND
511           SRC_REC_DEL_IND
512           CLM_STS_CD
513           lne_sts_cd
514           enc_ind
515           most_rcnt_clm_ind
516  ;
517
518  run;

WARNING: Multiple lengths were specified for the variable ICN_NBR by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable mcaid_id by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_MCAID_ID by input data set(s).
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_NPI_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_TYP_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_MCAID_ID by input data set(s).
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_NPI_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_TYP_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ATTD_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable SUPV_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable FAC_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable CLM_TYP_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable pos_cd by input data set(s). This can cause
         truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_1_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_2_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_3_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_4_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable proc_cd by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_1_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_2_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_3_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_4_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable RVN_CD by input data set(s). This can cause
         truncation of data.
NOTE: There were 0 observations read from the data set DB.clm_lne_fact_v.
      WHERE (CURR_REC_IND='Y') and (SRC_REC_DEL_IND='N') and (CLM_STS_CD='P') and (lne_sts_cd='P')
      and (most_rcnt_clm_ind='Y') and (enc_ind='N') and (PUT(ICN_NBR, $MYICNS32767.)='KEEP');
NOTE: The data set OUT.CLM_LINES_1519 has 0 observations and 29 variables.
NOTE: DATA statement used (Total process time):
      real time           1:52:50.73
      cpu time            1:25:19.06


NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.4 (TS1M7)
      Licensed to UNIVERSITY OF COLORADO SYSTEM - SFA - T&R, Site 70082279.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Analytical products:

      SAS/STAT 15.2
      SAS/ETS 15.2
      SAS/OR 15.2
      SAS/IML 15.2
      SAS/QC 15.2

NOTE: Additional host information:

 X64_10PRO WIN 10.0.19041  Workstation

NOTE: SAS initialization used:
      real time           3.82 seconds
      cpu time            3.32 seconds

1    %include "S:/FHPC/DATA/HCPF_Data_files_SECURE/Kim/isp/isp_utilization/02_code/00_global.sas";
NOTE: Libref OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\04_data
NOTE: Format PCTFMT has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.09 seconds
      cpu time            0.07 seconds


NOTE: Writing HTML Body file: sashtml.htm
NOTE: Overwriting existing template/link: Base.Freq.OneWayList
NOTE: TABLE 'Base.Freq.OneWayList' has been saved to: SASUSER.TEMPLAT
NOTE: PROCEDURE TEMPLATE used (Total process time):
      real time           1.29 seconds
      cpu time            0.93 seconds


NOTE: Libref DB was successfully assigned as follows:
      Engine:        ODBC
      Physical Name:
NOTE: Libref VARLEN was successfully assigned as follows:
      Engine:        V9
      Physical Name:
      \\data.ucdenver.pvt\dept\SOM\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries\DBVarLength
      s
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.68 seconds
      cpu time            1.36 seconds


NOTE: Libref BHJT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries
NOTE: Libref VARLEN was successfully assigned as follows:
      Engine:        V9
      Physical Name:
      \\data.ucdenver.pvt\dept\SOM\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries\DBVarLength
      s
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.08 seconds
      cpu time            1.09 seconds


NOTE: Libref BHJT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries
NOTE: Informat AGE_RANGE has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds



240  proc sql;
241  create table out.clm_header_1819 as
242    select ICN_NBR  length = &ICN_NBR ,
243           mcaid_id length = &mcaid_id,
244           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
245           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
246           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
247           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
248           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
249           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
250           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
251           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
252           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
253           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
254           datepart(FRST_SVC_DT)  as FRST_SVC_DT,
255           datepart(LST_SVC_DT)   as LST_SVC_DT,
256           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT,
257           clm_ctg_cd     length = &clm_ctg_cd,
258           CLM_TYP_CD     length = &CLM_TYP_CD,
259           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
260           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
261           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
262           pd_amt,
263           tpl_pd_amt
264    from  db.CLM_DIM_V
265    where CURR_REC_IND = 'Y'
266      and SRC_REC_DEL_IND = 'N'
267      and CLM_STS_CD = 'P'
268      and most_rcnt_clm_ind = 'Y'
269      and enc_ind = 'N'
270      and mcaid_id in (SELECT clnt_id
271                    FROM out.clntid_1819);
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: There were 25018669 observations read from the data set DB.CLM_DIM_V.
      WHERE (CURR_REC_IND='Y') and (SRC_REC_DEL_IND='N') and (CLM_STS_CD='P') and
      (MOST_RCNT_CLM_IND='Y') and (ENC_IND='N');
NOTE: There were 2651615 observations read from the data set OUT.CLNTID_1819.
WARNING: The data set OUT.CLM_HEADER_1819 may be incomplete.  When this step was stopped there were
         21187211 observations and 22 variables.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5:50.85
      cpu time            5:04.00


272    order by mcaid_id;
273  quit;

274  proc sql;
275  create table out.clm_header_1819 as
276    select ICN_NBR  length = &ICN_NBR ,
277           mcaid_id length = &mcaid_id,
278           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
279           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
280           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
281           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
282           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
283           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
284           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
285           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
286           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
287           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
288           datepart(FRST_SVC_DT)  as FRST_SVC_DT format=yymmddd10.,
289           datepart(LST_SVC_DT)   as LST_SVC_DT format=yymmddd10.,
290           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT format=yymmddd10.,
291           clm_ctg_cd     length = &clm_ctg_cd,
292           CLM_TYP_CD     length = &CLM_TYP_CD,
293           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
294           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
295           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
296           pd_amt,
297           tpl_pd_amt
298    from  db.CLM_DIM_V (obs = 1000)
299    where CURR_REC_IND = 'Y'
300      and SRC_REC_DEL_IND = 'N'
301      and CLM_STS_CD = 'P'
302      and most_rcnt_clm_ind = 'Y'
303      and enc_ind = 'N'
304      and mcaid_id in (SELECT clnt_id
305                    FROM out.clntid_1819);
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: Table OUT.CLM_HEADER_1819 created, with 938 rows and 22 columns.

306    order by mcaid_id;
       -----
       180
ERROR 180-322: Statement is not valid or it is used out of proper order.

307  quit;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.60 seconds
      cpu time            2.17 seconds


308
309  * claim headers 1819;
310  proc sql;
311  create table out.clm_header_1819 as
312    select ICN_NBR  length = &ICN_NBR ,
313           mcaid_id length = &mcaid_id,
314           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
315           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
316           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
317           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
318           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
319           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
320           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
321           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
322           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
323           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
324           datepart(FRST_SVC_DT)  as FRST_SVC_DT format=yymmddd10.,
325           datepart(LST_SVC_DT)   as LST_SVC_DT format=yymmddd10.,
326           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT format=yymmddd10.,
327           clm_ctg_cd     length = &clm_ctg_cd,
328           CLM_TYP_CD     length = &CLM_TYP_CD,
329           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
330           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
331           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
332           pd_amt,
333           tpl_pd_amt
334    from  db.CLM_DIM_V (obs = 1000)
335    where CURR_REC_IND = 'Y'
336      and SRC_REC_DEL_IND = 'N'
337      and CLM_STS_CD = 'P'
338      and most_rcnt_clm_ind = 'Y'
339      and enc_ind = 'N'
340      and mcaid_id in (SELECT clnt_id
341                    FROM out.clntid_1819)
342    order by mcaid_id;
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: Table OUT.CLM_HEADER_1819 created, with 938 rows and 22 columns.

343  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.54 seconds
      cpu time            1.87 seconds


344
345  proc print data = out.clm_1819;
346  var drug_dspn_dt;
347  run;

NOTE: There were 1000 observations read from the data set OUT.CLM_1819.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           1.38 seconds
      cpu time            0.39 seconds


348  proc sql;
349  create table out.clm_header_1819 as
350    select ICN_NBR  length = &ICN_NBR ,
351           mcaid_id length = &mcaid_id,
352           ATTD_PROV_LOC_ID length = &ATTD_PROV_LOC_ID,
353           ATTD_PROV_LOC_NM length = &ATTD_PROV_LOC_NM,
354           REND_PROV_LOC_ID   length = &REND_PROV_LOC_ID,
355           REND_PROV_LOC_NM   length = &REND_PROV_LOC_NM,
356           REND_PROV_TYP_CD   length = &REND_PROV_TYP_CD,
357           REND_PROV_TYP_DESC length = &REND_PROV_TYP_DESC,
358           BILL_PROV_LOC_ID   length = &BILL_PROV_LOC_ID,
359           BILL_PROV_LOC_NM   length = &BILL_PROV_LOC_NM,
360           BILL_PROV_TYP_CD   length = &BILL_PROV_TYP_CD,
361           BILL_PROV_TYP_DESC length = &BILL_PROV_TYP_DESC,
362           datepart(FRST_SVC_DT)  as FRST_SVC_DT format=yymmddd10.,
363           datepart(LST_SVC_DT)   as LST_SVC_DT format=yymmddd10.,
364           datepart(DRUG_DSPN_DT) as DRUG_DSPN_DT format=yymmddd10.,
365           clm_ctg_cd     length = &clm_ctg_cd,
366           CLM_TYP_CD     length = &CLM_TYP_CD,
367           CTG_OF_SVC_CD  length = &CTG_OF_SVC_CD,
368           CLNT_CNTY_CD   length = &CLNT_CNTY_CD,
369           CLNT_CNTY_DESC length = &CLNT_CNTY_DESC,
370           pd_amt,
371           tpl_pd_amt
372    from  db.CLM_DIM_V
373    where CURR_REC_IND = 'Y'
374      and SRC_REC_DEL_IND = 'N'
375      and CLM_STS_CD = 'P'
376      and most_rcnt_clm_ind = 'Y'
377      and enc_ind = 'N'
378      and mcaid_id in (SELECT clnt_id
379                    FROM out.clntid_1819)
380    order by mcaid_id;
NOTE: Invalid (or missing) arguments to the DATEPART function have caused the function to return a
      missing value.
NOTE: Table OUT.CLM_HEADER_1819 created, with 230635966 rows and 22 columns.

381  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:49:34.07
      cpu time            1:12:15.90


382  proc print data = out.clm_header_1819 (obs=100);
383  run;

NOTE: There were 100 observations read from the data set OUT.CLM_HEADER_1819.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.31 seconds
      cpu time            0.23 seconds


384
385  data out.clm_1819 (drop = SBMT_MCAID_ID);
386  set  out.clm_1819;
387  if '01Jul2018'd <= FRST_SVC_DT <= '30Jun2019'd;
388  run;

WARNING: The variable SBMT_MCAID_ID in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1000 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLM_1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           2.31 seconds
      cpu time            0.20 seconds


389  data out.clm_1819;
390  set  out.clm_1819;
391  if '01Jul2018'd <= FRST_SVC_DT <= '30Jun2019'd;
392  run;

NOTE: There were 0 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLM_1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.01 seconds


393  data out.clm_header_1819_SFY;
394  set  out.clm_header_1819;
395  if '01Jul2018'd <= FRST_SVC_DT <= '30Jun2019'd;
396  run;

NOTE: There were 230635966 observations read from the data set OUT.CLM_HEADER_1819.
NOTE: The data set OUT.CLM_HEADER_1819_SFY has 22406479 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           17:07.13
      cpu time            1:48.48


397  data out.clms_1518_grp1819 (drop = SBMT_MCAID_ID);
398  set  out.clm_1819;
399  if '01Jul2015'd <= FRST_SVC_DT <= '30Jun2018'd;
400  run;

WARNING: The variable SBMT_MCAID_ID in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLMS_1518_GRP1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds


401  data out.clms_1518_grp1819;
402  set  out.clm_1819;
403  if '01Jul2015'd <= FRST_SVC_DT <= '30Jun2018'd;
404  run;

NOTE: There were 0 observations read from the data set OUT.CLM_1819.
NOTE: The data set OUT.CLMS_1518_GRP1819 has 0 observations and 153 variables.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds


405  * Get claims for 2015-2019 SFY for 1819 members;
406  data out.clm_header_1518_grp1819;
407  set  out.clm_header_1819;
408  if '01Jul2015'd <= FRST_SVC_DT <= '30Jun2018'd;
409  run;

NOTE: There were 230635966 observations read from the data set OUT.CLM_HEADER_1819.
NOTE: The data set OUT.CLM_HEADER_1518_GRP1819 has 68458900 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           19:56.03
      cpu time            2:17.81


410
411  proc print data = out.clm_header_1819_SFY (obs=100);
412  run;

NOTE: There were 100 observations read from the data set OUT.CLM_HEADER_1819_SFY.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.29 seconds
      cpu time            0.21 seconds


413  data out.clm_header_1519_group1;
414  set  out.clm_header_1819_SFY
415       out.clm_header_1518_grp1819;
416  run;

NOTE: There were 22406479 observations read from the data set OUT.CLM_HEADER_1819_SFY.
NOTE: There were 68458900 observations read from the data set OUT.CLM_HEADER_1518_GRP1819.
NOTE: The data set OUT.CLM_HEADER_1519_GROUP1 has 90865379 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           12:06.75
      cpu time            1:43.40


417  proc sort data = out.clm_header_1519_group1 (keep=ICN_NBR) out=out.icns_group1_1519 nodupkey;
418  by ICN_NBR;
419  run;

NOTE: There were 90865379 observations read from the data set OUT.CLM_HEADER_1519_GROUP1.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set OUT.ICNS_GROUP1_1519 has 90865379 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           7:45.59
      cpu time            2:55.35


420
421  data MyIcnFmt;
422     set out.icns_group1_1519 (keep = ICN_NBR);
423
424     retain hlo " ";
425     fmtname = "$MyIcns" ;
426     type    = "c" ;
427     start   = ICN_NBR;
428     label   = 'KEEP';
429     output ;
430     if eof then do ;
431        start = " " ;
432        label = " " ;
433        hlo   = "o" ;
434        output ;
435     end ;
436  run;

NOTE: Variable eof is uninitialized.
NOTE: There were 90865379 observations read from the data set OUT.ICNS_GROUP1_1519.
NOTE: The data set WORK.MYICNFMT has 90865379 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           1:31.36
      cpu time            1:20.39


437
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           23.35 seconds
      cpu time            23.32 seconds

ERROR: Memory capacity exceeded after 9639087 ranges and 9639086 labels.
NOTE: The SAS System stopped processing this step because of insufficient memory.
ERROR: The SAS System stopped processing this step because of insufficient memory.
NOTE: There were 9639087 observations read from the data set WORK.MYICNFMT.
438  proc format cntlin = MyIcnFmt;
439  run;
440
441  * diagnoses ;


442  proc sql;
443  create table OUT.diagTable_1519 as
444    select distinct
445           a.ICN_NBR length = &ICN_NBR,
446           a.DIAG_PRSNT_ON_ADMSN_CD  length = &DIAG_PRSNT_ON_ADMSN_CD,
447           a.DIAG_CD length = &DIAG_CD,
448           a.DIAG_DESC length = &DIAG_DESC,
449           a.CD_SET_CD length = &CD_SET_CD,
450           a.CD_SET_VER_NBR length = &CD_SET_VER_NBR,
451           a.DIAG_SEQ_CD length = &DIAG_SEQ_CD,
452           a.DIAG_SEQ_DESC length = &DIAG_SEQ_DESC
453    from db.CLM_DIAG_FACT_V as a
454    where a.CURR_REC_IND = 'Y'
455      and a.SRC_REC_DEL_IND = 'N'
456      and put(ICN_NBR, $MyIcns. ) = "KEEP"
457  ;
NOTE: Table OUT.DIAGTABLE_1519 created, with 0 rows and 8 columns.

458  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           57:25.35
      cpu time            56:26.00


459
460  * claim lines ;
461
462  data out.clm_lines_1519;
463
464    length mcaid_id $ &mcaid_id
465           ICN_NBR $ &ICN_NBR
466           RVN_CD $ &RVN_CD
467           CLM_TYP_CD $ &CLM_TYP_CD
468           pos_cd $ &pos_cd
469           DIAG_1_CD $ &DIAG_1_CD
470           DIAG_2_CD $ &DIAG_2_CD
471           DIAG_3_CD $ &DIAG_3_CD
472           DIAG_4_CD $ &DIAG_4_CD
473           proc_cd   $ &proc_cd
474           PROC_MOD_1_CD $ &PROC_MOD_1_CD
475           PROC_MOD_2_CD  $ &PROC_MOD_2_CD
476           PROC_MOD_3_CD  $ &PROC_MOD_3_CD
477           PROC_MOD_4_CD $ &PROC_MOD_4_CD
478           ATTD_PROV_LOC_ID $ &ATTD_PROV_LOC_ID
479           BILL_PROV_MCAID_ID $ &BILL_PROV_MCAID_ID
480           BILL_PROV_NPI_ID   $ &BILL_PROV_NPI_ID
481
482           BILL_PROV_LOC_ID   $ &BILL_PROV_LOC_ID
483           REND_PROV_LOC_ID   $ &REND_PROV_LOC_ID
484           REND_PROV_MCAID_ID $ &REND_PROV_MCAID_ID
485           REND_PROV_NPI_ID   $ &REND_PROV_NPI_ID
486
487           BILL_PROV_TYP_CD   $ &BILL_PROV_TYP_CD
488           REND_PROV_TYP_CD   $ &REND_PROV_TYP_CD
489
490           FAC_PROV_LOC_ID    $ &FAC_PROV_LOC_ID
491           SUPV_PROV_LOC_ID    $ &SUPV_PROV_LOC_ID
492  ;
493
494    set db.clm_lne_fact_v ( keep = mcaid_id ICN_NBR lne_nbr LNE_FRST_SVC_DT LNE_LST_SVC_DT RVN_CD
494! CLM_TYP_CD proc_cd
495                                   BILL_PROV_MCAID_ID  BILL_PROV_NPI_ID  BILL_PROV_LOC_ID
495! REND_PROV_LOC_ID REND_PROV_MCAID_ID
496                                   REND_PROV_NPI_ID  ATTD_PROV_LOC_ID BILL_PROV_TYP_CD
496! REND_PROV_TYP_CD FAC_PROV_LOC_ID
497                                   SUPV_PROV_LOC_ID CURR_REC_IND SRC_REC_DEL_IND pos_cd CLM_STS_CD
497! lne_sts_cd enc_ind
498                                   most_rcnt_clm_ind PROC_MOD_1_CD PROC_MOD_2_CD PROC_MOD_3_CD
498! PROC_MOD_4_CD DIAG_1_CD
499                                   DIAG_2_CD DIAG_3_CD DIAG_4_CD BILL_UNT_QTY
500                           );
501    where CURR_REC_IND = 'Y'
502      and SRC_REC_DEL_IND = 'N'
503      and CLM_STS_CD = 'P'
504      and lne_sts_cd = 'P'
505      and most_rcnt_clm_ind = 'Y'
506      and enc_ind = 'N'
507      and put(ICN_NBR, $MyIcns. ) = "KEEP"
508  ;
509               /* variables to ensure the claim is valid and paid: conditioned on in the where
509! statement */
510    drop   CURR_REC_IND
511           SRC_REC_DEL_IND
512           CLM_STS_CD
513           lne_sts_cd
514           enc_ind
515           most_rcnt_clm_ind
516  ;
517
518  run;

WARNING: Multiple lengths were specified for the variable ICN_NBR by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable mcaid_id by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_MCAID_ID by input data set(s).
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_NPI_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable BILL_PROV_TYP_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_MCAID_ID by input data set(s).
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_NPI_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable REND_PROV_TYP_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ATTD_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable SUPV_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable FAC_PROV_LOC_ID by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable CLM_TYP_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable pos_cd by input data set(s). This can cause
         truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_1_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_2_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_3_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable DIAG_4_CD by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable proc_cd by input data set(s). This can
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_1_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_2_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_3_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable PROC_MOD_4_CD by input data set(s). This
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable RVN_CD by input data set(s). This can cause
         truncation of data.
NOTE: There were 0 observations read from the data set DB.clm_lne_fact_v.
      WHERE (CURR_REC_IND='Y') and (SRC_REC_DEL_IND='N') and (CLM_STS_CD='P') and (lne_sts_cd='P')
      and (most_rcnt_clm_ind='Y') and (enc_ind='N') and (PUT(ICN_NBR, $MYICNS32767.)='KEEP');
NOTE: The data set OUT.CLM_LINES_1519 has 0 observations and 29 variables.
NOTE: DATA statement used (Total process time):
      real time           1:52:50.73
      cpu time            1:25:19.06


519
520  proc sort data = out.clm_header_1819_SFY (keep=ICN_NBR) out=out.icns_1819 nodupkey;
521  by ICN_NBR;
522  run;

NOTE: There were 22406479 observations read from the data set OUT.CLM_HEADER_1819_SFY.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set OUT.ICNS_1819 has 22406479 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           1:58.37
      cpu time            44.03 seconds


522!      *90865379;

523
524  data MyIcnFmt;
525     set out.icns_1819 (keep = ICN_NBR);
526
527     retain hlo " ";
528     fmtname = "$MyIcns" ;
529     type    = "c" ;
530     start   = ICN_NBR;
531     label   = 'KEEP';
532     output ;
533     if eof then do ;
534        start = " " ;
535        label = " " ;
536        hlo   = "o" ;
537        output ;
538     end ;
539  run;

NOTE: Variable eof is uninitialized.
NOTE: There were 22406479 observations read from the data set OUT.ICNS_1819.
NOTE: The data set WORK.MYICNFMT has 22406479 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           23.54 seconds
      cpu time            21.01 seconds


540
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           25.51 seconds
      cpu time            25.04 seconds

ERROR: Memory capacity exceeded after 9639085 ranges and 9639084 labels.
NOTE: The SAS System stopped processing this step because of insufficient memory.
ERROR: The SAS System stopped processing this step because of insufficient memory.
NOTE: There were 9639085 observations read from the data set WORK.MYICNFMT.
541  proc format cntlin = MyIcnFmt;
542  run;


