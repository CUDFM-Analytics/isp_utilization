NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.4 (TS1M7)
      Licensed to UNIVERSITY OF COLORADO SYSTEM - SFA - T&R, Site 70082279.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Analytical products:

      SAS/STAT 15.2
      SAS/ETS 15.2
      SAS/OR 15.2
      SAS/IML 15.2
      SAS/QC 15.2

NOTE: Additional host information:

 X64_10PRO WIN 10.0.19041  Workstation

NOTE: SAS initialization used:
      real time           1.01 seconds
      cpu time            0.73 seconds

1    %INCLUDE "S:/FHPC/DATA/HCPF_DATA_files_SECURE/Kim/isp/isp_utilization/code/util_00_config.sas";
NOTE: Libref DATA was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\data
NOTE: Library RAW does not exist.
NOTE: Libref INT was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\data\interim
NOTE: Library OUT does not exist.
NOTE: Libref ANA was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\AnalyticSubset
NOTE: Libref VARLEN was successfully assigned as follows:
      Engine:        V9
      Physical Name:
      \\data.ucdenver.pvt\dept\SOM\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries\DBVarLeng
      ths
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.54 seconds
      cpu time            0.32 seconds


NOTE: Format AGE_CAT_ has been output.
NOTE: Format BUDGET_GRP_NEW_ has been output.
NOTE: Format PCMP_TYPE_RC has been output.
NOTE: Format ADJ_PD_TOTAL_YRCAT_ has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds


NOTE: Format PCTFMT has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds


NOTE: Writing HTML Body file: sashtml.htm
NOTE: TABLE 'Base.Freq.OneWayList' has been saved to: WORK.TEMPLAT
NOTE: PROCEDURE TEMPLATE used (Total process time):
      real time           0.32 seconds
      cpu time            0.23 seconds


212  PROC PRINT DATA = int.util_memlist_elig1618 (obs=10) ;
213  WHERE ind_elig16 eq 0 ;
214  RUN ;

NOTE: There were 10 observations read from the data set INT.UTIL_MEMLIST_ELIG1618.
      WHERE ind_elig16=0;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds


215  PROC PRINT DATA = int.util_memlist_elig1618 (obs=10) ;
216  WHERE ind_elig16 eq 1 ;
217  RUN ;

NOTE: There were 10 observations read from the data set INT.UTIL_MEMLIST_ELIG1618.
      WHERE ind_elig16=1;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds


218                proc print data = ana.qry_longitudinal (obs = 1000);
219              where mcaid_id in ("A001791", "A003524","A000405","A002526","A003219");
220              run ;

NOTE: There were 427 observations read from the data set ANA.QRY_LONGITUDINAL.
      WHERE mcaid_id in ('A000405', 'A001791', 'A002526', 'A003219', 'A003524');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           9:10.59
      cpu time            23.56 seconds


221  PROC CONTENTS
222       DATA = ana.qry_longitudinal
223  VARNUM;
224  RUN;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.39 seconds
      cpu time            0.01 seconds


225  DATA util_elig1618;
226  SET  ana.qry_longitudinal (KEEP = mcaid_id month ) ;
227  WHERE month ge '01JUL2016'd
228  AND   month le '30JUN2019'd
229  AND   mcaid_id in (SELECT mcaid_ID FROM int.memlist);
                        ------
                        22
                        76
ERROR: Syntax error while parsing WHERE clause.
ERROR 22-322: Syntax error, expecting one of the following: a quoted string, a numeric constant,
              a datetime constant, a missing value, -.

ERROR 76-322: Syntax error, statement will be ignored.

230  RUN ;

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.UTIL_ELIG1618 may be incomplete.  When this step was stopped there were
         0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.00 seconds


231  PROC SQL ;
232  CREATE TABLE util_elig1618 AS
233  SELECT a.mcaid_id
234       , a.month
235  FROM   ana.qry_longitudinal as a,
236         int.memlist as b
237  WHERE  a.mcaid_id = b.mcaid_id
238  AND    month ge '01JUL2016'd
239  AND    month le '30JUN2019'd ;
NOTE: There were 3110436 observations read from the data set ANA.QRY_LONGITUDINAL.
      WHERE (month>='01JUL2016'D and month<='30JUN2019'D);
NOTE: There were 3903027 observations read from the data set INT.MEMLIST.
WARNING: The data set WORK.UTIL_ELIG1618 may be incomplete.  When this step was stopped there were
         5586704 observations and 2 variables.
WARNING: Data set WORK.UTIL_ELIG1618 was not replaced because this step was stopped.
NOTE: PROCEDURE SQL used (Total process time):
      real time           51.75 seconds
      cpu time            3.17 seconds


240  QUIT ;

241  PROC SQL ;
242  CREATE TABLE util_elig1618 AS
243  SELECT a.mcaid_id
244       , a.month
245  FROM   ana.qry_longitudinal as a,
246         int.memlist as b
247  WHERE  a.mcaid_id = b.mcaid_id
248  AND    month ge '01JUL2016'd
249  AND    month le '30JUN2019'd ;
NOTE: Table WORK.UTIL_ELIG1618 created, with 91498671 rows and 2 columns.

250  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           8:33.58
      cpu time            32.43 seconds


251
252  DATA util_elig1618a ;
253  SET  util_elig1618 ;
254  FY   = year(intnx('year.7', month, 0, 'BEGINNING')); * create FY variable ;
255  RUN ;

NOTE: There were 91498671 observations read from the data set WORK.UTIL_ELIG1618.
NOTE: The data set WORK.UTIL_ELIG1618A has 91498671 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           20.89 seconds
      cpu time            20.85 seconds


256  PROC SQL ;
257  CREATE TABLE util_elig1618b AS
258  SELECT mcaid_id
259       , FY
260       , count (month) as n_months
261  FROM util_elig1618a
262  GROUP BY mcaid_id, FY ;
NOTE: Table WORK.UTIL_ELIG1618B created, with 3204918 rows and 3 columns.

263  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.04 seconds
      cpu time            24.87 seconds


264  PROC SORT DATA = util_elig1618a NODUPKEY ; BY _ALL_ ; RUN ;

NOTE: There were 91498671 observations read from the data set WORK.UTIL_ELIG1618A.
NOTE: 57205190 observations with duplicate key values were deleted.
NOTE: The data set WORK.UTIL_ELIG1618A has 34293481 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           7.43 seconds
      cpu time            17.51 seconds



265  PROC SQL ;
266  CREATE TABLE util_elig1618 AS
267  SELECT mcaid_id
268       , month
269  FROM   ana.qry_longitudinal
270  WHERE  mcaid_id IN (SELECT mcaid_id FROM int.memlist)
271  AND    month ge '01JUL2016'd
272  AND    month le '30JUN2019'd ;
NOTE: Table WORK.UTIL_ELIG1618 created, with 34293481 rows and 2 columns.

273  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           9:00.20
      cpu time            31.70 seconds


274  DATA util_elig1618a ;
275  SET  util_elig1618 ;
276  FY   = year(intnx('year.7', month, 0, 'BEGINNING')); * create FY variable ;
277  RUN ;

NOTE: There were 34293481 observations read from the data set WORK.UTIL_ELIG1618.
NOTE: The data set WORK.UTIL_ELIG1618A has 34293481 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           7.97 seconds
      cpu time            8.00 seconds


278  PROC SORT DATA = util_elig1618a NODUPKEY ; BY _ALL_ ; RUN ;

NOTE: There were 34293481 observations read from the data set WORK.UTIL_ELIG1618A.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.UTIL_ELIG1618A has 34293481 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           3.38 seconds
      cpu time            8.71 seconds



279  PROC SQL ;
280  CREATE TABLE util_elig1618b AS
281  SELECT mcaid_id
282       , FY
283       , count (month) as n_obs_FY
284  FROM util_elig1618a
285  GROUP BY mcaid_id, FY ;
NOTE: Table WORK.UTIL_ELIG1618B created, with 3204918 rows and 3 columns.

286  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.87 seconds
      cpu time            10.23 seconds


287  DATA memlist_elig1618 ;
288  SET  util_elig1618b   ;
289  BY FY ;
290  elig16 = n_obs_FY ge 1 ;
291  elig17 = n_obs_FY ge 1 ;
292  elig18 = n_obs_fy ge1 ;
                       ---
                       22
ERROR 22-322: Syntax error, expecting one of the following: !, !!, &, *, **, +, -, /, <, <=, <>, =,
              >, ><, >=, AND, EQ, GE, GT, IN, LE, LT, MAX, MIN, NE, NG, NL, NOTIN, OR, ^=, |, ||,
              ~=.

293  RUN ;

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.MEMLIST_ELIG1618 may be incomplete.  When this step was stopped there
         were 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


294  DATA memlist_elig1618 ;
295  SET  util_elig1618b   ;
296  BY FY ;
297  elig16 = n_obs_FY ge 1 ;
298  elig17 = n_obs_FY ge 1 ;
299  elig18 = n_obs_fy ge 1 ;
300  RUN ;

ERROR: BY variables are not properly sorted on data set WORK.UTIL_ELIG1618B.
MCAID_ID=A000405 FY=2018 n_obs_FY=12 FIRST.FY=1 LAST.FY=1 elig16=. elig17=. elig18=. _ERROR_=1 _N_=3
NOTE: The SAS System stopped processing this step because of errors.
NOTE: There were 4 observations read from the data set WORK.UTIL_ELIG1618B.
WARNING: The data set WORK.MEMLIST_ELIG1618 may be incomplete.  When this step was stopped there
         were 2 observations and 6 variables.
WARNING: Data set WORK.MEMLIST_ELIG1618 was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


301  PROC SORT DATA = memlist_elig1618b ; BY FY ; RUN ;
ERROR: File WORK.MEMLIST_ELIG1618B.DATA does not exist.

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds



302  PROC SORT DATA = util_elig1618b ; BY FY ; RUN ;

NOTE: There were 3204918 observations read from the data set WORK.UTIL_ELIG1618B.
NOTE: The data set WORK.UTIL_ELIG1618B has 3204918 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.23 seconds
      cpu time            0.60 seconds



303  DATA memlist_elig1618 ;
304  SET  util_elig1618b   ;
305  BY FY ;
306  elig16 = n_obs_FY ge 1 ;
307  elig17 = n_obs_FY ge 1 ;
308  elig18 = n_obs_fy ge 1 ;
309  RUN ;

NOTE: There were 3204918 observations read from the data set WORK.UTIL_ELIG1618B.
NOTE: The data set WORK.MEMLIST_ELIG1618 has 3204918 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds


310  PROC SORT DATA = util_elig1618 NODUPKEY out=int.memlist_elig1618; BY mcaid_id, FY ; RUN ;
                                                                                  -
                                                                                  22
                                                                                  200
ERROR: Variable FY not found.

ERROR 22-322: Syntax error, expecting one of the following: a name, ;, -, :, DECENDING, DESCENDING,
              DESENDING, _ALL_, _CHARACTER_, _CHAR_, _NUMERIC_.

ERROR 200-322: The symbol is not recognized and will be ignored.

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set INT.MEMLIST_ELIG1618 may be incomplete.  When this step was stopped there
         were 0 observations and 0 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds



311  PROC SORT DATA = util_elig1618 NODUPKEY out=int.memlist_elig1618; BY mcaid_id FY ; RUN ;
ERROR: Variable FY not found.

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set INT.MEMLIST_ELIG1618 may be incomplete.  When this step was stopped there
         were 0 observations and 0 variables.
WARNING: Data set INT.MEMLIST_ELIG1618 was not replaced because this step was stopped.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds



312  PROC SORT DATA = util_elig1618a NODUPKEY out=int.memlist_elig1618; BY mcaid_id FY ; RUN ;

NOTE: There were 34293481 observations read from the data set WORK.UTIL_ELIG1618A.
NOTE: 31088563 observations with duplicate key values were deleted.
NOTE: The data set INT.MEMLIST_ELIG1618 has 3204918 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           3.96 seconds
      cpu time            5.90 seconds



313  PROC SORT DATA = util_elig1618a NODUPKEY out=int.memlist_elig1618 ( KEEP= mcaid_id FY ) ; BY
313! mcaid_id FY ; RUN ; *3204918 : 3;

NOTE: There were 34293481 observations read from the data set WORK.UTIL_ELIG1618A.
NOTE: 31088563 observations with duplicate key values were deleted.
NOTE: The data set INT.MEMLIST_ELIG1618 has 3204918 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           3.66 seconds
      cpu time            5.82 seconds



314  PROC SQL ;
315  CREATE TABLE memlist_elig1618 as
316  SELECT a.mcaid_id
317       , b.FY
318  FROM int.memlist as A
319  FULL JOIN int.memlist_elig1618 as B
320  on a.mcaid_id = b.mcaid_id ;
NOTE: Table WORK.MEMLIST_ELIG1618 created, with 9180369 rows and 2 columns.

321  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.13 seconds
      cpu time            1.01 seconds


322
323  DATA int.memlist_elig1618_final ;
324  SET  int.memlist_elig1618 ;
325  elig_YYcat = FY ne . ;
326  RUN ;

NOTE: There were 3204918 observations read from the data set INT.MEMLIST_ELIG1618.
NOTE: The data set INT.MEMLIST_ELIG1618_FINAL has 3204918 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           2.24 seconds
      cpu time            0.28 seconds


327  DATA int.memlist_elig1618_final ;
328  SET  memlist_elig1618 ;
329  elig_YYcat = FY ne . ;
330  RUN ;

NOTE: There were 9180369 observations read from the data set WORK.MEMLIST_ELIG1618.
NOTE: The data set INT.MEMLIST_ELIG1618_FINAL has 9180369 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           4.41 seconds
      cpu time            0.56 seconds


331  PROC SQL ;
332  CREATE TABLE adj_cat AS
333  SELECT a.*
334       , b.*
335  FROM util_1618_cat as a
336  FULL JOIN int.util_memlist_elig1618 as b
337  on a.mcaid_id = b.mcaid_id ;
ERROR: File WORK.UTIL_1618_CAT.DATA does not exist.
338  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds


339  PROC SQL ;
340  CREATE TABLE adj_cat AS
341  SELECT a.*
342       , b.*
343  FROM int.util_1618_cat as a
344  FULL JOIN int.util_memlist_elig1618 as b
345  on a.mcaid_id = b.mcaid_id ;
WARNING: Variable mcaid_id already exists on file WORK.ADJ_CAT.
NOTE: Table WORK.ADJ_CAT created, with 1594348 rows and 10 columns.

346  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.56 seconds
      cpu time            0.68 seconds


347  PROC SQL ;
348  CREATE TABLE adj_cat AS
349  SELECT a.*
350       , b.*
351  FROM int.util_memlist_elig1618  as a
352  FULL JOIN int.util_1618_cat as b
353  on a.mcaid_id = b.mcaid_id ;
WARNING: Variable MCAID_ID already exists on file WORK.ADJ_CAT.
NOTE: Table WORK.ADJ_CAT created, with 1594348 rows and 10 columns.

354  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.24 seconds
      cpu time            0.40 seconds


354!        *1594348 ;

355  DATA util_memlist_elig1618 ;
356  SET  int.util_memlist_elig1618 ;
357  ind_elig_16cat = ind_elig16-1 ;
358  ind_elig_17cat = ind_elig17-1;
359  ind_elig_18cat = ind_elig18 - 1 ;
360  RUN ;

NOTE: There were 1594348 observations read from the data set INT.UTIL_MEMLIST_ELIG1618.
NOTE: The data set WORK.UTIL_MEMLIST_ELIG1618 has 1594348 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.66 seconds
      cpu time            0.14 seconds


361  Ran checks and it looked good ;
     ---
     180

ERROR 180-322: Statement is not valid or it is used out of proper order.

362  PROC SQL ;
363  CREATE TABLE adj_cat AS
364  SELECT COALESCE (a.mcaid_id, b.mcaid_id) as mcaid_id
365       , a.*
366       , b.*
367  FROM int.util_memlist_elig1618  as a
368  FULL JOIN int.util_1618_cat as b
369  on a.mcaid_id = b.mcaid_id ;
WARNING: Variable mcaid_id already exists on file WORK.ADJ_CAT.
WARNING: Variable MCAID_ID already exists on file WORK.ADJ_CAT.
NOTE: Table WORK.ADJ_CAT created, with 1594348 rows and 10 columns.

370  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.31 seconds
      cpu time            0.48 seconds


370!        *1594348 ;

371  PROC SQL ;
372  CREATE TABLE adj_cat2 AS
373  SELECT mcaid_id
374       , case when ind_elig16 = 0 then -1
375              else _2016
376              end as cat16;
                             -
                             22
                             76
ERROR 22-322: Syntax error, expecting one of the following: a quoted string, ',', AS, FORMAT, FROM,
              INFORMAT, INTO, LABEL, LEN, LENGTH, TRANSCODE.

ERROR 76-322: Syntax error, statement will be ignored.

377       , case when ind_elig17 = 0 then -1
          -
          180
ERROR 180-322: Statement is not valid or it is used out of proper order.

378              else _2017
379              end as cat17 ;
380       , case when ind_elig18 = 0 then -1
          -
          180
ERROR 180-322: Statement is not valid or it is used out of proper order.

381              else _2018
382              end as cat18 ;
383       , ind_elig16
          -
          180
ERROR 180-322: Statement is not valid or it is used out of proper order.

384       , ind_elig17
385       , ind_elig18
386       , _2016
387       , _2017
388       , _2018
389  FROM adj_cat ;
390  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds


391  PROC SQL ;
392  CREATE TABLE adj_cat2 AS
393  SELECT mcaid_id
394       , case when ind_elig16 = 0 then -1
395              else _2016
396              end as cat16;
                             -
                             22
                             76
ERROR 22-322: Syntax error, expecting one of the following: a quoted string, ',', AS, FORMAT, FROM,
              INFORMAT, INTO, LABEL, LEN, LENGTH, TRANSCODE.

ERROR 76-322: Syntax error, statement will be ignored.

397       , case when ind_elig17 = 0 then -1
          -
          180
ERROR 180-322: Statement is not valid or it is used out of proper order.

398              else _2017
399              end as cat17
400       , case when ind_elig18 = 0 then -1
401              else _2018
402              end as cat18
403       , ind_elig16
404       , ind_elig17
405       , ind_elig18
406       , _2016
407       , _2017
408       , _2018
409  FROM adj_cat ;
410  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


411  PROC SQL ;
412  CREATE TABLE adj_cat2 AS
413  SELECT mcaid_id
414       , case when ind_elig16 = 0 then -1
415              else _2016
416              end as cat16
417       , case when ind_elig17 = 0 then -1
418              else _2017
419              end as cat17
420       , case when ind_elig18 = 0 then -1
421              else _2018
422              end as cat18
423       , ind_elig16
424       , ind_elig17
425       , ind_elig18
426       , _2016
427       , _2017
428       , _2018
429  FROM adj_cat ;
NOTE: Table WORK.ADJ_CAT2 created, with 1594348 rows and 10 columns.

430  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.21 seconds
      cpu time            0.22 seconds


431  DATA int.util_1618_cat_adj ;
432  SET  adj_cat2 ;
433  cost_2016 = coalesce(cat16,0);
434  cost_2017 = coalesce(cat17,0);
435  cost_2018 = coalesce(cat18,0);
436  RUN ;

NOTE: There were 1594348 observations read from the data set WORK.ADJ_CAT2.
NOTE: The data set INT.UTIL_1618_CAT_ADJ has 1594348 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           3.99 seconds
      cpu time            0.43 seconds


437  DATA int.util_1618_cat_adj_A ;
438  SET  adj_cat2 ;
439  cost_2016 = coalesce(cat16,0);
440  cost_2017 = coalesce(cat17,0);
441  cost_2018 = coalesce(cat18,0);
442  RUN ;

NOTE: There were 1594348 observations read from the data set WORK.ADJ_CAT2.
NOTE: The data set INT.UTIL_1618_CAT_ADJ_A has 1594348 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           4.19 seconds
      cpu time            0.32 seconds


443  proc sql;
444  create table int.util_1618_long as
445  select mcaid_id
446       , FY
447       , sum(pd_tot_q_adj) as pd_tot_fy_adj
448  from util_1618
449  group by MCAID_ID, FY;
ERROR: File WORK.UTIL_1618.DATA does not exist.
450  quit;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds

450!       *2396891 : 3 - reduced to approx 1/5th ;


451  PROC RANK DATA = int.util_1618_long
452       GROUPS    = 100
453       OUT       = util1618r;
454       VAR       pd_tot_fy_adj ;
455       BY        FY ;
456       RANKS     adj_pd_rank ;
457  RUN ;

NOTE: There were 2396891 observations read from the data set INT.UTIL_1618_LONG.
NOTE: The data set WORK.UTIL1618R has 2396891 observations and 4 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           4.04 seconds
      cpu time            0.53 seconds


458  PROC SORT DATA = util1618r ; by mcaid_id ; RUN ;

NOTE: There were 2396891 observations read from the data set WORK.UTIL1618R.
NOTE: The data set WORK.UTIL1618R has 2396891 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.19 seconds
      cpu time            0.48 seconds



459  PROC TRANSPOSE DATA = util1618r
460       OUT = util1618r2 (DROP= _NAME_ _LABEL_);
461  by mcaid_id ;
462  ID FY ;
463  VAR adj_pd_rank;
464  RUN;

NOTE: There were 2396891 observations read from the data set WORK.UTIL1618R.
NOTE: The data set WORK.UTIL1618R2 has 1051841 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           2.86 seconds
      cpu time            2.84 seconds


464!       * 105841 : 4 ;

465  * Make cats but keep the original vals to check ;
466  DATA int.util_1618_cat  ;
467  SET  util1618r2     ;
468  adj_pd_total_16cat_A = put(_2016, adj_pd_total_YRcat_.);
469  adj_pd_total_17cat_A = put(_2017, adj_pd_total_YRcat_.);
470  adj_pd_total_18cat_A = put(_2018, adj_pd_total_YRcat_.);
471  RUN ;

NOTE: There were 1051841 observations read from the data set WORK.UTIL1618R2.
NOTE: The data set INT.UTIL_1618_CAT has 1051841 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           2.52 seconds
      cpu time            0.34 seconds


472  DATA util_1618_cat  ;
473  SET  util1618r2     ;
474  adj_pd_total_16cat_A = put(_2016, adj_pd_total_YRcat_.);
475  adj_pd_total_17cat_A = put(_2017, adj_pd_total_YRcat_.);
476  adj_pd_total_18cat_A = put(_2018, adj_pd_total_YRcat_.);
477  RUN ;

NOTE: There were 1051841 observations read from the data set WORK.UTIL1618R2.
NOTE: The data set WORK.UTIL_1618_CAT has 1051841 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.27 seconds
      cpu time            0.18 seconds


478  PROC SQL ;
479  CREATE TABLE adj_cat AS
480  SELECT COALESCE (a.mcaid_id, b.mcaid_id) as mcaid_id
481       , a.*
482       , b.*
483  FROM int.util_memlist_elig1618  as a
484  FULL JOIN util_1618_cat as b
485  on a.mcaid_id = b.mcaid_id ;
WARNING: Variable mcaid_id already exists on file WORK.ADJ_CAT.
WARNING: Variable MCAID_ID already exists on file WORK.ADJ_CAT.
NOTE: Table WORK.ADJ_CAT created, with 1594348 rows and 10 columns.

486  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.96 seconds
      cpu time            0.61 seconds


486!        *1594348 ;

487  DATA adj_cat2 ;
488  SET  adj_cat ;
489  IF ind_elig16 = 0 then adj_pd_total_16cat = -1 ;
490  IF ind_elig16 = 1 and _2016 = . then adj_pd_total_16cat = adj_pd_total_16cat_A;
491  RUN ;

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column).
      490:59
NOTE: There were 1594348 observations read from the data set WORK.ADJ_CAT.
NOTE: The data set WORK.ADJ_CAT2 has 1594348 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.15 seconds
      cpu time            0.14 seconds


492
493  PROC SQL ;
494  CREATE TABLE adj_cat2 AS
495  SELECT mcaid_id
496       , case when ind_elig16 = 0 then -1
497              when (ind_elig16 = 1 AND _2016 = .) then 0
498              else adj_pd_total_16cat_A
499              end as adj_pd_total_16cat
500       , case when ind_elig17 = 0 then -1
501              else _2017
502              end adj_pd_total_16cat
                     ------------------
                     22
ERROR 22-322: Syntax error, expecting one of the following: !, !!, &, *, **, +, ',', -, /, <, <=,
              <>, =, >, >=, ?, AND, AS, CONTAINS, EQ, EQT, FROM, GE, GET, GT, GTT, LE, LET, LIKE,
              LT, LTT, NE, NET, OR, ^=, |, ||, ~=.

503       , case when ind_elig18 = 0 then -1
                 ----
                 22
                 76
ERROR 22-322: Syntax error, expecting one of the following: a name, ;, (, ',', '.', ANSIMISS, AS,
              CROSS, EXCEPT, FULL, GROUP, HAVING, INNER, INTERSECT, JOIN, LEFT, NATURAL, NOMISS,
              ORDER, OUTER, RIGHT, UNION, WHERE.

ERROR 76-322: Syntax error, statement will be ignored.

504              else _2018
505              end as cat18
506       , ind_elig16
507       , ind_elig17
508       , ind_elig18
509       , _2016
510       , _2017
511       , _2018
512  FROM adj_cat ;
513  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds


514  PROC SQL ;
515  CREATE TABLE adj_cat2 AS
516  SELECT mcaid_id
517       , case when ind_elig16 = 0 then -1
518              when (ind_elig16 = 1 AND _2016 = .) then 0
519              else adj_pd_total_16cat_A
520              end as adj_pd_total_16cat
521       , case when ind_elig17 = 0 then -1
522              else _2017
523              end as cat17
524       , case when ind_elig18 = 0 then -1
525              else _2018
526              end as cat18
527       , ind_elig16
528       , ind_elig17
529       , ind_elig18
530       , _2016
531       , _2017
532       , _2018
533  FROM adj_cat ;
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
534  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


535  PROC SQL ;
536  CREATE TABLE adj_cat2 AS
537  SELECT mcaid_id
538       , case when ind_elig16 = 0 then -1
539              when (ind_elig16 = 1 AND _2016 = .) then 0
540              else adj_pd_total_16cat_A
541              end as adj_pd_total_16cat
542       , case when ind_elig17 = 0 then -1
543              when (ind_elig17 = 1 and _2017 = .) then 0
544              else adj_pd_total_17cat_A
545              end as adj_pd_total_17cat
546       , case when ind_elig18 = 0 then -1
547              when (ind_elig17 = 1 AND _2018 = .) then 0
548              else adj_pd_total_18cat_A
549              end as adj_pd_total_18cat
550       , ind_elig16
551       , ind_elig17
552       , ind_elig18
553       , _2016
554       , _2017
555       , _2018
556  FROM adj_cat ;
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
557  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


558  PROC SQL ;
559  CREATE TABLE adj_cat2 AS
560  SELECT mcaid_id
561       , case when ind_elig16 = 0 then -1
562              when (ind_elig16 = 1 AND _2016 = .) then 0
563              else adj_pd_total_16cat_A
564              end as adj_pd_total_16cat
565       , case when ind_elig17 = 0 then -1
566              when (ind_elig17 = 1 and _2017 = .) then 0
567              else adj_pd_total_17cat_A
568              end as adj_pd_total_17cat
569       , case when ind_elig18 = 0 then -1
570              when (ind_elig18 = 1 AND _2018 = .) then 0
571              else adj_pd_total_18cat_A
572              end as adj_pd_total_18cat
573       , ind_elig16
574       , ind_elig17
575       , ind_elig18
576       , _2016
577       , _2017
578       , _2018
579  FROM adj_cat ;
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
ERROR: Result of WHEN clause 3 is not the same data type as the preceding results.
580  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


581
582  PROC SQL ;
583  CREATE TABLE adj_cat2 AS
584  SELECT mcaid_id
585       , case when ind_elig16 = 0 then '-1'
586              when (ind_elig16 = 1 AND _2016 = .) then '0'
587              else adj_pd_total_16cat_A
588              end as adj_pd_total_16cat
589       , case when ind_elig17 = 0 then '-1'
590              when (ind_elig17 = 1 and _2017 = .) then '0'
591              else adj_pd_total_17cat_A
592              end as adj_pd_total_17cat
593       , case when ind_elig18 = 0 then '-1'
594              when (ind_elig18 = 1 AND _2018 = .) then '0'
595              else adj_pd_total_18cat_A
596              end as adj_pd_total_18cat
597       , ind_elig16
598       , ind_elig17
599       , ind_elig18
600       , _2016
601       , _2017
602       , _2018
603  FROM adj_cat ;
NOTE: Table WORK.ADJ_CAT2 created, with 1594348 rows and 10 columns.

604  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.29 seconds


605  PROC SQL ;
606  CREATE TABLE adj_cat2 AS
607  SELECT mcaid_id
608       , case when ind_elig16 = 0 then '-1'
609              when (ind_elig16 = 1 AND _2016 = .) then '0'
610              else adj_pd_total_16cat_A
611              end as adj_pd_total_16cat
612       , case when ind_elig17 = 0 then '-1'
613              when (ind_elig17 = 1 and _2017 = .) then '0'
614              else adj_pd_total_17cat_A
615              end as adj_pd_total_17cat
616       , case when ind_elig18 = 0 then '-1'
617              when (ind_elig18 = 1 AND _2018 = .) then '0'
618              else adj_pd_total_18cat_A
619              end as adj_pd_total_18cat
620       , adj_pd_total_16cat_A
621       , adj_pd_total_17cat_A
622       , adj_pd_total_18cat_A
623       , ind_elig16
624       , ind_elig17
625       , ind_elig18
626       , _2016
627       , _2017
628       , _2018
629  FROM adj_cat ;
NOTE: Table WORK.ADJ_CAT2 created, with 1594348 rows and 13 columns.

630  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.30 seconds
      cpu time            0.31 seconds


631      PROC FORMAT;
632
633      VALUE age_cat_
634      0 - 5 = 1
635      6 -10 = 2
636      11-15 = 3
637      16-20 = 4
638      21-44 = 5
639      45-64 = 6 ;
NOTE: Format AGE_CAT_ is already on the library WORK.FORMATS.
NOTE: Format AGE_CAT_ has been output.
640
641      VALUE budget_grp_new_
642      5    = "MAGI TO 68% FPL"
643      3    = "MAGI 69 - 133% FPL"
644      6-10 = "Disabled"
645      11   = "Foster Care"
646      12   = "MAGI Eligible Children"
647      Other = "Other";
NOTE: Format BUDGET_GRP_NEW_ is already on the library WORK.FORMATS.
NOTE: Format BUDGET_GRP_NEW_ has been output.
648
649      VALUE pcmp_type_rc
650      32 = "FQHC"
651      45 = "RHC"
652      51 = "SHS"
653      61 = "IHS"
654      62 = "IHS"
655      Other = "Other";
NOTE: Format PCMP_TYPE_RC is already on the library WORK.FORMATS.
NOTE: Format PCMP_TYPE_RC has been output.
656
657      VALUE adj_pd_total_YRcat_
658      0 = 0
659      1 - 50  = 1
660      51 - 75 = 2
661      76 - 95 = 3
662      96 - 99 = 4
663      Other = .;
NOTE: Format ADJ_PD_TOTAL_YRCAT_ is already on the library WORK.FORMATS.
NOTE: Format ADJ_PD_TOTAL_YRCAT_ has been output.
664
665      RUN;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


666
667  * Make cats but keep the original vals to check ;
668  DATA util_1618_cat  ;
669  SET  util1618r2     ;
670  adj_pd_total_16cat_A = put(_2016, adj_pd_total_YRcat_.);
671  adj_pd_total_17cat_A = put(_2017, adj_pd_total_YRcat_.);
672  adj_pd_total_18cat_A = put(_2018, adj_pd_total_YRcat_.);
673  RUN ;

NOTE: There were 1051841 observations read from the data set WORK.UTIL1618R2.
NOTE: The data set WORK.UTIL_1618_CAT has 1051841 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.28 seconds
      cpu time            0.17 seconds


673!       *1051841 ;

674  DATA int.util_1618_cat  ;
675  SET  util1618r2     ;
676  adj_pd_total_16cat_A = put(_2016, adj_pd_total_YRcat_.);
677  adj_pd_total_17cat_A = put(_2017, adj_pd_total_YRcat_.);
678  adj_pd_total_18cat_A = put(_2018, adj_pd_total_YRcat_.);
679  RUN ;

NOTE: There were 1051841 observations read from the data set WORK.UTIL1618R2.
NOTE: The data set INT.UTIL_1618_CAT has 1051841 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           1.01 seconds
      cpu time            0.28 seconds


679!       *1051841 ;

680  PROC SQL ;
681  CREATE TABLE adj_cat AS
682  SELECT COALESCE (a.mcaid_id, b.mcaid_id) as mcaid_id
683       , a.*
684       , b.*
685  FROM int.util_memlist_elig1618  as a
686  FULL JOIN util_1618_cat as b
687  on a.mcaid_id = b.mcaid_id ;
WARNING: Variable mcaid_id already exists on file WORK.ADJ_CAT.
WARNING: Variable MCAID_ID already exists on file WORK.ADJ_CAT.
NOTE: Table WORK.ADJ_CAT created, with 1594348 rows and 10 columns.

688  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.95 seconds
      cpu time            0.54 seconds


688!        *1594348 ;

689  DATA adj_cat2 ;
690  SET  adj_cat ;
691  IF ind_elig16 = 0 then adj_pd_total_16cat = -1 ;
692  IF ind_elig16 = 1 and _2016 = . then adj_pd_total_16cat_A end as adj_pd_total_16cat ;
                                          --------------------
                                          180
ERROR 180-322: Statement is not valid or it is used out of proper order.

693  RUN ;

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.ADJ_CAT2 may be incomplete.  When this step was stopped there were 0
         observations and 11 variables.
WARNING: Data set WORK.ADJ_CAT2 was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


694  DATA adj_cat2 ;
695  SET  adj_cat ;
696  IF ind_elig16 = 0 then adj_pd_total_16cat = -1 ;
697  IF ind_elig16 = 1 and _2016 = . then adj_pd_total_16cat_A end as adj_pd_total_16cat ;
                                          --------------------
                                          180
ERROR 180-322: Statement is not valid or it is used out of proper order.

698  RUN ;

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.ADJ_CAT2 may be incomplete.  When this step was stopped there were 0
         observations and 11 variables.
WARNING: Data set WORK.ADJ_CAT2 was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


699
700  PROC SQL ;
701  CREATE TABLE adj_cat2 AS
702  SELECT mcaid_id
703       , case when ind_elig16 = 0 then '-1'
704              when (ind_elig16 = 1 AND _2016 = .) then '0'
705              else adj_pd_total_16cat_A
706              end as adj_pd_total_16cat
707       , case when ind_elig17 = 0 then '-1'
708              when (ind_elig17 = 1 and _2017 = .) then '0'
709              else adj_pd_total_17cat_A
710              end as adj_pd_total_17cat
711       , case when ind_elig18 = 0 then '-1'
712              when (ind_elig18 = 1 AND _2018 = .) then '0'
713              else adj_pd_total_18cat_A
714              end as adj_pd_total_18cat
715       , adj_pd_total_16cat_A
716       , adj_pd_total_17cat_A
717       , adj_pd_total_18cat_A
718       , ind_elig16
719       , ind_elig17
720       , ind_elig18
721       , _2016
722       , _2017
723       , _2018
724  FROM adj_cat ;
NOTE: Table WORK.ADJ_CAT2 created, with 1594348 rows and 13 columns.

725  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds


726
727  PROC SQL ;
728  CREATE TABLE int.adj_pd_total_YYcat_final AS
729  SELECT mcaid_id
730       , case when ind_elig16 = 0 then '-1'
731              when (ind_elig16 = 1 AND _2016 = .) then '0'
732              else adj_pd_total_16cat_A
733              end as adj_pd_total_16cat
734       , case when ind_elig17 = 0 then '-1'
735              when (ind_elig17 = 1 and _2017 = .) then '0'
736              else adj_pd_total_17cat_A
737              end as adj_pd_total_17cat
738       , case when ind_elig18 = 0 then '-1'
739              when (ind_elig18 = 1 AND _2018 = .) then '0'
740              else adj_pd_total_18cat_A
741              end as adj_pd_total_18cat
742       , adj_pd_total_16cat_A
743       , adj_pd_total_17cat_A
744       , adj_pd_total_18cat_A
745       , ind_elig16
746       , ind_elig17
747       , ind_elig18
748       , _2016
749       , _2017
750       , _2018
751  FROM adj_cat ;
NOTE: Table INT.ADJ_PD_TOTAL_YYCAT_FINAL created, with 1594348 rows and 13 columns.

752  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.83 seconds
      cpu time            0.42 seconds


753  PROC SQL ;
754  CREATE TABLE a0 as
755  SELECT a.mcaid_id
756       , a.FY
757
758       , b.time
759       , b.pcmp_loc_id
760       , b.n_months_per_q
761       , b.ind_isp as intervention
762
763  FROM int.memlist as A
764
765  /* has to be left join because b isn't age-subset  */
766  LEFT JOIN int.memlist_attr_qrtr_1921 AS b
767  ON   a.mcaid_id = b.mcaid_id
768  AND  a.FY       = b.FY
769
770  QUIT ;
     ----
     22
     76
ERROR 22-322: Syntax error, expecting one of the following: !, !!, &, *, **, +, ',', -, /, <, <=,
              <>, =, >, >=, AND, EQ, EQT, GE, GET, GROUP, GT, GTT, HAVING, LE, LET, LT, LTT, NE,
              NET, OR, ORDER, WHERE, ^=, |, ||, ~=.

ERROR 76-322: Syntax error, statement will be ignored.

NOTE: PROCEDURE SQL used (Total process time):
      real time           5.30 seconds
      cpu time            0.10 seconds


