NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.4 (TS1M7)
      Licensed to UNIVERSITY OF COLORADO SYSTEM - SFA - T&R, Site 70082279.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Analytical products:

      SAS/STAT 15.2
      SAS/ETS 15.2
      SAS/OR 15.2
      SAS/IML 15.2
      SAS/QC 15.2

NOTE: Additional host information:

 X64_10PRO WIN 10.0.19041  Workstation

NOTE: SAS initialization used:
      real time           0.98 seconds
      cpu time            0.75 seconds

1    %INCLUDE "S:/FHPC/DATA/HCPF_DATA_files_SECURE/Kim/isp/isp_utilization/code/util_00_params.sas";
NOTE: Libref ANA was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\AnalyticSubset
NOTE: Libref DATASETS was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\datasets
NOTE: Libref DATA was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\data\util_analysis
NOTE: Libref FEB was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\data\hcpf_pres
NOTE: Libref TMP was successfully assigned as follows:
      Engine:        V9
      Physical Name: S:\FHPC\DATA\HCPF_Data_files_SECURE\Kim\isp\isp_utilization\tmp
NOTE: Libref VARLEN was successfully assigned as follows:
      Engine:        V9
      Physical Name:
      \\data.ucdenver.pvt\dept\SOM\FHPC\DATA\HCPF_Data_files_SECURE\HCPF_SqlServer\queries\DBVarLeng
      ths
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.54 seconds
      cpu time            0.34 seconds


NOTE: Format AGECAT has been output.
NOTE: Format AGEHCPF has been output.
NOTE: Format AGE7CAT has been output.
NOTE: Format FY3_ has been output.
NOTE: Format FY7_ has been output.
NOTE: Format NSERVE has been output.
NOTE: Format CAPVSH has been output.
NOTE: Format MATCHN has been output.
NOTE: Format PCMP_TYPE_RC has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds



164  proc sort data = data.qrylong_y15_22 ; by mcaid_id ;       *53384196;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds


165  proc sort data = data.memlist        ; by mcaid_id ; run ;

NOTE: There were 19132176 observations read from the data set DATA.MEMLIST.
NOTE: The data set DATA.MEMLIST has 19132176 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           6.93 seconds
      cpu time            4.31 seconds


165!                                                             *1594686;
166
167  * ==== Reduce qrylong to 19-22 only ==========================================;
168  data  analysis0 ( drop = fy ) ;
169  set   data.qrylong_y15_22;
170  where month ge '01JUL2019'd
171  and   month le '30JUN2022'd ;
172  run;

NOTE: There were 40999955 observations read from the data set DATA.QRYLONG_Y15_22.
      WHERE (month>='01JUL2019'D and month<='30JUN2022'D);
NOTE: The data set WORK.ANALYSIS0 has 40999955 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           1:28.55
      cpu time            8.73 seconds


173   proc sql;
174                  create table n_mem_analysis1 as
175                  select count ( distinct mcaid_id ) as n_mcaid_id
176                  from analysis0;
NOTE: Table WORK.N_MEM_ANALYSIS1 created, with 1 rows and 1 columns.

177                  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.50 seconds
      cpu time            5.50 seconds


178
179                  proc print data = n_mem_analysis1 ; run; * 1594348;
NOTE: Writing HTML Body file: sashtml.htm

NOTE: There were 1 observations read from the data set WORK.N_MEM_ANALYSIS1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.41 seconds
      cpu time            0.32 seconds


180  proc sql;
181  create table analysis1 as
182  select a.*
183       /* join monthly */
184       , b.pd_amt_pc
185       , b.pd_amt_rx
186       , b.pd_amt_total
187       , b.n_pc
188       , b.n_er
189       , b.n_total
190
191       /* join bho  */
192       , c.bh_n_er
193       , c.bh_n_other
194
195       /* join telehealth utilization  */
196       , d.n_tele
197       , d.pd_tele
198
199  FROM analysis0 AS a
200
201  LEFT JOIN data.util_19_22 AS b
202  ON a.mcaid_id = b.mcaid_id AND a.month = b.month
203
204  LEFT JOIN data.bho_19_22 AS c
205  ON a.mcaid_id = c.mcaid_id AND a.month = c.month
206
207  LEFT JOIN data.memlist_tele_monthly AS d
208  ON a.mcaid_id = d.mcaid_id AND a.month = d.month;
NOTE: Table WORK.ANALYSIS1 created, with 40999955 rows and 37 columns.

209
210  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           42.66 seconds
      cpu time            40.70 seconds


211  proc sql;
212  create table analysis3 as
213  select *
214       , count (month) as n_month
215  from tmp.analysis2
216  group by mcaid_id, q ;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.ANALYSIS3 created, with 40999955 rows and 39 columns.

217  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:52.46
      cpu time            11.73 seconds


217!        *40999955;

218  proc freq data = analysis3 ; tables n_month ; run ;

NOTE: There were 40999955 observations read from the data set WORK.ANALYSIS3.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           3.54 seconds
      cpu time            3.46 seconds



219  PROC SQL;
220  CREATE TABLE analysis4 AS
221
222         SELECT a.*
223              , b.pcmp_loc_id AS pcmp_attr_qrtr
224              , b.ind_isp     AS ind_isp_ever
225              , c.dt_prac_isp
226         FROM analysis3 as a
227
228         LEFT JOIN feb.unique_mem_quarter AS b
229         ON a.mcaid_id = b.mcaid_id AND a.q = b.q
230
231         LEFT JOIN data.isp_un_pcmp as c
232         on a.pcmp_loc_id = c.pcmp_loc_id;
NOTE: Table WORK.ANALYSIS4 created, with 40999955 rows and 42 columns.

233  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           43.27 seconds
      cpu time            47.24 seconds


234
235  PROC CONTENTS
236       DATA = analysis4 VARNUM;
237  RUN;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds


238  proc print data = analysis4 (obs=250) ; run ;

NOTE: There were 250 observations read from the data set WORK.ANALYSIS4.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.46 seconds
      cpu time            0.45 seconds



239  proc print data = analysis4 (obs=250) ;
240  var dt_prac_isp ind_isp_ever ;
241  where ind_isp_ever = 1 ;
242  run ;

NOTE: There were 250 observations read from the data set WORK.ANALYSIS4.
      WHERE ind_isp_ever=1;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.05 seconds
      cpu time            0.03 seconds


243  proc print data = analysis4 (obs=250) ;
244  var dt_prac_isp ind_isp_ever mcaid_id;
245  where ind_isp_ever = 1 ;
246  run ;

NOTE: There were 250 observations read from the data set WORK.ANALYSIS4.
      WHERE ind_isp_ever=1;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds


247  proc print data = analysis4 ;
248  where mcaid_id in ("P861019", "L155867");
249  run ;

NOTE: There were 66 observations read from the data set WORK.ANALYSIS4.
      WHERE mcaid_id in ('L155867', 'P861019');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           3.65 seconds
      cpu time            3.48 seconds


250  proc print data = feb.unique_mem_quarter ;
251  where mcaid_id in ("P861019", "L155867");
252  run ;

NOTE: There were 22 observations read from the data set FEB.UNIQUE_MEM_QUARTER.
      WHERE mcaid_id in ('L155867', 'P861019');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           6.14 seconds
      cpu time            0.23 seconds


253  PROC SQL;
254  CREATE TABLE analysis4 AS
255         SELECT a.*
256              , b.pcmp_loc_id AS
257              , b.ind_isp     AS ind_isp_ever
                 -
                 22
ERROR 22-322: Expecting a name.

258         FROM analysis3 as a
259         LEFT JOIN feb.unique_mem_quarter AS b
260         ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
261  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds


262  PROC SQL;
263  CREATE TABLE analysis4 AS
264         SELECT a.*
265              , b.pcmp_loc_id AS
266              , b.ind_isp     AS ind_isp_ever
                 -
                 22
ERROR 22-322: Expecting a name.

267         FROM analysis3 AS a
268         LEFT JOIN feb.unique_mem_quarter AS b
269         ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
270  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds


271  PROC SQL;
272  CREATE TABLE analysis4 AS
273  SELECT a.*
274       , b.pcmp_loc_id AS
275       , b.ind_isp AS ind_isp_ever
          -
          22
ERROR 22-322: Expecting a name.

276  FROM analysis3 AS a
277  LEFT JOIN feb.unique_mem_quarter AS b
278  ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
279  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds


280  PROC SQL;
281  CREATE TABLE analysis4 AS
282  SELECT a.*
283       , b.pcmp_loc_id AS pcmp_attr_qrtr
284       , b.ind_isp AS ind_isp_ever
285  FROM analysis3 AS a
286  LEFT JOIN feb.unique_mem_quarter AS b
287  ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
NOTE: Table WORK.ANALYSIS4 created, with 40999955 rows and 41 columns.

288  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           30.33 seconds
      cpu time            15.20 seconds


289  PROC SQL;
290  CREATE TABLE analysis5 as
291  SELECT a.*
292       , a.pcmp_attr_qrtr
293       , b.dt_prac_isp
294  LEFT JOIN data.isp_un_pcmp as b
     ----
     22
     76
ERROR 22-322: Syntax error, expecting one of the following: a quoted string, !, !!, &, *, **, +,
              ',', -, /, <, <=, <>, =, >, >=, ?, AND, AS, BETWEEN, CONTAINS, EQ, EQT, FORMAT, FROM,
              GE, GET, GT, GTT, IN, INFORMAT, INTO, IS, LABEL, LE, LEN, LENGTH, LET, LIKE, LT, LTT,
              NE, NET, NOT, NOTIN, OR, TRANSCODE, ^, ^=, |, ||, ~, ~=.

ERROR 76-322: Syntax error, statement will be ignored.

295  ON a.pcmp_attr_qrtr = b.pcmp_loc_id;
296  QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds


297
298  PROC SQL;
299  CREATE TABLE analysis5 as
300  SELECT a.*
301       , a.pcmp_attr_qrtr
302       , b.dt_prac_isp
303  FROM analysis4 AS a
304  LEFT JOIN data.isp_un_pcmp AS b
305  ON a.pcmp_attr_qrtr = b.pcmp_loc_id;
ERROR: Expression using equals (=) has components that are of different data types.
306  QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds


307  PROC SQL;
308  CREATE TABLE analysis4 AS
309  SELECT a.*
310       , b.pcmp_loc_id AS pcmp_attr_qrtr format best12.
311       , b.ind_isp AS ind_isp_ever
312  FROM analysis3 AS a
313  LEFT JOIN feb.unique_mem_quarter AS b
314  ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
NOTE: Table WORK.ANALYSIS4 created, with 40999955 rows and 41 columns.

315  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           22.00 seconds
      cpu time            15.48 seconds


316
317  PROC SQL;
318  CREATE TABLE analysis5 as
319  SELECT a.*
320       , a.pcmp_attr_qrtr
321       , b.dt_prac_isp
322  FROM analysis4 AS a
323  LEFT JOIN data.isp_un_pcmp AS b
324  ON a.pcmp_attr_qrtr = b.pcmp_loc_id;
ERROR: Expression using equals (=) has components that are of different data types.
325  QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds


326  PROC SQL;
327  CREATE TABLE analysis4 AS
328  SELECT a.*
329       , b.pcmp_loc_id AS pcmp_attr_qrtr format $best12.
330       , b.ind_isp AS ind_isp_ever
331  FROM analysis3 AS a
332  LEFT JOIN feb.unique_mem_quarter AS b
333  ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
ERROR: Numeric expression requires a numeric format.
334  QUIT ;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds


335  PROC SQL;
336  CREATE TABLE analysis4 AS
337  SELECT a.*
338       , b.pcmp_loc_id AS pcmp_attr_qrtr
339       , b.ind_isp AS ind_isp_ever
340  FROM analysis3 AS a
341  LEFT JOIN feb.unique_mem_quarter AS b
342  ON a.mcaid_id = b.mcaid_id AND a.q = b.q ;
NOTE: Table WORK.ANALYSIS4 created, with 40999955 rows and 41 columns.

343  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           22.37 seconds
      cpu time            15.93 seconds


344  data data.isp_un_pcmp;
345  set  isp ;
ERROR: File WORK.ISP.DATA does not exist.
346  if   pcmp_loc_id = "162015" and dt_prac_isp = '01JUL2020'd then delete ;
347  pcmp2 = input(pcmp_loc_id, 8.);
348  run ;

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set DATA.ISP_UN_PCMP may be incomplete.  When this step was stopped there were 0
         observations and 3 variables.
WARNING: Data set DATA.ISP_UN_PCMP was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.03 seconds



348!       *117;

349  data data.isp_un_pcmp;
350  set  data.isp_un_pcmp ;
351  if   pcmp_loc_id = "162015" and dt_prac_isp = '01JUL2020'd then delete ;
352  pcmp2 = input(pcmp_loc_id, 8.);
353  run ;

NOTE: There were 117 observations read from the data set DATA.ISP_UN_PCMP.
NOTE: The data set DATA.ISP_UN_PCMP has 117 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.00 seconds


353!       *117;

354  data data.isp_un_pcmp;
355  set  data.isp_un_pcmp ;
356  if   pcmp_loc_id = "162015" and dt_prac_isp = '01JUL2020'd then delete ;
357  pcmp2 = input(pcmp_loc_id, 8.);
358  drop pcmp_loc_id;
359  rename pcmp2 = pcmp_loc_id;
360  run ;

NOTE: There were 117 observations read from the data set DATA.ISP_UN_PCMP.
NOTE: The data set DATA.ISP_UN_PCMP has 117 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.03 seconds


361  PROC SQL;
362  CREATE TABLE analysis5 as
363  SELECT a.*
364       , a.pcmp_attr_qrtr
365       , b.dt_prac_isp
366  FROM analysis4 AS a
367  LEFT JOIN data.isp_un_pcmp AS b
368  ON a.pcmp_attr_qrtr = b.pcmp_loc_id;
WARNING: Variable pcmp_attr_qrtr already exists on file WORK.ANALYSIS5.
NOTE: Table WORK.ANALYSIS5 created, with 40999955 rows and 42 columns.

369  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           31.54 seconds
      cpu time            42.21 seconds


370  proc print data = analysis4 (obs=250) ;
371  var dt_prac_isp ind_isp_ever mcaid_id;
ERROR: Variable DT_PRAC_ISP not found.
372  where ind_isp_ever = 1 ;
373  run ;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


374  proc print data = analysis5 (obs=250) ;
375  var dt_prac_isp ind_isp_ever mcaid_id;
376  where ind_isp_ever = 1 ;
377  run ;

NOTE: There were 250 observations read from the data set WORK.ANALYSIS5.
      WHERE ind_isp_ever=1;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.10 seconds
      cpu time            0.06 seconds


378  proc print data = analysis5 ;
379  var dt_prac_isp ind_isp_ever pcmp_loc_id pcmp_attr_qrtr month;
380  where mcaid_id in ("P861019", "L155867");
381  run ;

NOTE: There were 66 observations read from the data set WORK.ANALYSIS5.
      WHERE mcaid_id in ('L155867', 'P861019');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           3.65 seconds
      cpu time            3.50 seconds


382  proc print data = analysis5 ;
383  var  mcaid_id dt_prac_isp ind_isp_ever pcmp_loc_id pcmp_attr_qrtr month;
384  where mcaid_id in ("P861019", "L155867");
385  run ;

NOTE: There were 66 observations read from the data set WORK.ANALYSIS5.
      WHERE mcaid_id in ('L155867', 'P861019');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           3.66 seconds
      cpu time            3.64 seconds


386  DATA analysis6;
387  SET  analysis5;
388  IF   ind_isp_ever = 1 and month >= dt_prac_isp then ind_isp_dtd = 1;
389  ELSE ind_isp_dtd = 0;
390  RUN;

NOTE: There were 40999955 observations read from the data set WORK.ANALYSIS5.
NOTE: The data set WORK.ANALYSIS6 has 40999955 observations and 43 variables.
NOTE: DATA statement used (Total process time):
      real time           12.09 seconds
      cpu time            9.25 seconds


391  DATA analysis6;
392  SET  analysis5;
393  IF   ind_isp_ever = 1 and month >= dt_prac_isp then ind_isp_dtd = 1;
394  ELSE ind_isp_dtd = 0;
395  RUN;

NOTE: There were 40999955 observations read from the data set WORK.ANALYSIS5.
NOTE: The data set WORK.ANALYSIS6 has 40999955 observations and 43 variables.
NOTE: DATA statement used (Total process time):
      real time           18.13 seconds
      cpu time            9.39 seconds


396          proc print data = analysis6 (obs = 100) ;
397          var mcaid_id month dt_prac_isp ind_isp_ever ind_isp_dtd;
398          where dt_prac_isp ne . ;
399          run ;

NOTE: There were 100 observations read from the data set WORK.ANALYSIS6.
      WHERE dt_prac_isp not = .;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds


400          data tmp.analysis6;
401          set  analysis6;
402          run;

NOTE: There were 40999955 observations read from the data set WORK.ANALYSIS6.
NOTE: The data set TMP.ANALYSIS6 has 40999955 observations and 43 variables.
NOTE: DATA statement used (Total process time):
      real time           2:22.21
      cpu time            12.48 seconds


403  proc print data = analysis6 (obs = 100) ; run ;

NOTE: There were 100 observations read from the data set WORK.ANALYSIS6.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.21 seconds
      cpu time            0.20 seconds



404  proc contents data = analysis6 ; run ;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds


405  proc contents data = analysis6 varnum; run ;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds


406  proc sql;
407  create table data.analytic_dataset as
408  select *
409       , case when ind_isp_ever = 1 then max(ind_isp_dtd) else 0 end as ind_isp_dtd_qrtr
410  from analysis6
411  group by mcaid_id, q;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table DATA.ANALYTIC_DATASET created, with 40999955 rows and 44 columns.

412  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2:47.15
      cpu time            51.96 seconds


413  proc print data = data.analytic_dataset (obs = 1000) ;
414  var pcmp:  ind_isp_ever dt_prac_isp ind_isp_dtd ind_isp_dtd_qrtr ;
415  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.42 seconds
      cpu time            0.35 seconds


416  proc print data = data.analytic_dataset (obs = 1000) ;
417  var pcmp:  ind_isp_ever dt_prac_isp ind_isp_dtd ind_isp_dtd_qrtr ;
418  where dt_prac_isp ne . ;
419  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE dt_prac_isp not = .;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.43 seconds
      cpu time            0.37 seconds


420  proc print data = data.analytic_dataset (obs = 1000) ;
421  var pcmp:  ind_isp_ever dt_prac_isp month ind_isp_dtd ind_isp_dtd_qrtr ;
422  where dt_prac_isp ne . ;
423  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE dt_prac_isp not = .;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.50 seconds
      cpu time            0.45 seconds


424  proc print data = data.analytic_dataset (obs = 1000) ;
NOTE: Writing HTML Body file: sashtml1.htm
425  var mcaid_id pcmp:  ind_isp_ever dt_prac_isp month ind_isp_dtd ind_isp_dtd_qrtr ;
426  where dt_prac_isp ne . ;
427  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE dt_prac_isp not = .;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           1.04 seconds
      cpu time            0.84 seconds


428  proc print data = data.analytic_dataset (obs = 1000) ;
429  var mcaid_id pcmp:  ind_isp_ever dt_prac_isp month q ind_isp_dtd ind_isp_dtd_qrtr ;
430  where dt_prac_isp ne . ;
431  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE dt_prac_isp not = .;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.55 seconds
      cpu time            0.46 seconds


432  proc print data = data.analytic_dataset (obs = 1000) ;
433  var mcaid_id pcmp:  ind_isp_ever dt_prac_isp month q ind_isp_dtd ind_isp_dtd_qrtr n_: ;
434  where dt_prac_isp ne . ;
435  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE dt_prac_isp not = .;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.74 seconds
      cpu time            0.70 seconds


436  proc print data = data.analytic_dataset (obs = 1000) ;
437  var mcaid_id pcmp:  ind_isp_ever dt_prac_isp month q ind_isp_dtd ind_isp_dtd_qrtr n_: ;
438  where mcaid_id = "A005156";   *was dt_prac_isp ne . ;
439  run ;

NOTE: There were 24 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE mcaid_id='A005156';
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds


440  PROC CONTENTS
NOTE: Writing HTML Body file: sashtml2.htm
441       DATA = analysis6 VARNUM;
442  RUN;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.50 seconds
      cpu time            0.46 seconds


443  data data.analytic_dataset ;
444  set  data.analytic_dataset ;
445
446  if pd_amt_pc    = . then pd_amt_pc = 0;
447  if pd_amt_rx    = . then pd_amt_rx = 0;
448  if pd_amt_total = . then pd_amt_total = 0;
449  if n_pc         = . then n_pc = 0;
450  if n_er         = . then n_er = 0;
451  if n_total      = . then n_total = 0;
452  if bh_n_er      = . then bh_n_er = 0;
453  if bh_n_other   = . then bh_n_other = 0;
454  if n_tele       = . then n_tele = 0;
455  if pd_tele      = . then pd_tele = 0;
456  if dt_prac_isp  = . then dt_prac_isp = 0;
457
458  RUN;

NOTE: There were 40999955 observations read from the data set DATA.ANALYTIC_DATASET.
NOTE: The data set DATA.ANALYTIC_DATASET has 40999955 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           4:14.07
      cpu time            15.68 seconds


459  proc contents data = data.qrylong_y15_22 ; run ;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds


460  * GET MANAGED CARE VAR? ;
461  PROC SQL;
462  CREATE TABLE mgdCare AS
463  SELECT mcaid_id
464       , managedCare
465       , month
466  FROM ana.qry_longitudinal
467  WHERE mcaid_id in ( SELECT mcaid_id FROM data.memlist ) ;
NOTE: There were 142300453 observations read from the data set ANA.QRY_LONGITUDINAL.
NOTE: There were 19132176 observations read from the data set DATA.MEMLIST.
WARNING: The data set WORK.MGDCARE may be incomplete.  When this step was stopped there were
         95789314 observations and 3 variables.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7:03.86
      cpu time            34.18 seconds


468  RUN ;

469  PROC SQL;
470  CREATE TABLE mgdCare AS
471  SELECT mcaid_id
472       , managedCare
473       , month
474  FROM ana.qry_longitudinal
475  WHERE mcaid_id in ( SELECT mcaid_id FROM data.memlist ) ;
NOTE: Table WORK.MGDCARE created, with 118244270 rows and 3 columns.

476  QUIT ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           8:37.21
      cpu time            38.23 seconds


477  proc print data = mgdcare (obs = 100) ; run ;

NOTE: There were 100 observations read from the data set WORK.MGDCARE.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds



478
479          proc print data = data.analytic_dataset;
480          where mcaid_id in ("A020536","A023159", "A027267", "A044973","A027267");
481          var mcaid_id month q ind_isp_dtd_qrtr ind_isp_dtd ind_isp_ever pcmp_loc_id ;
482          run ;

NOTE: There were 128 observations read from the data set DATA.ANALYTIC_DATASET.
      WHERE mcaid_id in ('A020536', 'A023159', 'A027267', 'A044973');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           1:54.89
      cpu time            3.26 seconds


483
484  proc contents data = data.analytic_dataset;
485  run ;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.05 seconds
      cpu time            0.03 seconds


486  proc print data = data.analytic_dataset (obs = 1000) ;
487  var pd: n: ;
488  run ;

NOTE: There were 1000 observations read from the data set DATA.ANALYTIC_DATASET.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.47 seconds
      cpu time            0.43 seconds


489  proc contents data = data.analytic_dataset;
490  run ;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds


491  data data.analytic_dataset ;
492  set  data.analytic_dataset ;
493
494  if pd_amt_pc    = . then pd_amt_pc = 0;
495  if pd_amt_rx    = . then pd_amt_rx = 0;
496  if pd_amt_total = . then pd_amt_total = 0;
497  if n_pc         = . then n_pc = 0;
498  if n_er         = . then n_er = 0;
499  if n_total      = . then n_total = 0;
500  if bh_n_er      = . then bh_n_er = 0;
501  if bh_n_other   = . then bh_n_other = 0;
502  if n_tele       = . then n_tele = 0;
503  if pd_tele      = . then pd_tele = 0;
504  if dt_prac_isp  = . then dt_prac_isp = 0;
505
506  fy3=year(intnx('year.7', month, 0, 'BEGINNING'));
507
508  label FY           = "Fiscal Year"
509        RAE_ID       = "RAE ID"
510        age_end_fy   = "Age on Last Day FY"
511        bh_n_er      = "BH visits: ER"
512        bh_n_other   = "BH visits: Other"
513        dob          = "Date of Birth"
514        dt_prac_isp  = "Date ISP Enrollment"
515        ind_isp_dtd  = "ISP: Time-Varying"
516        ind_isp_ever = "ISP: Time-Invariant"
517        last_day_fy  = "Last Day of FY"
518        n_er         = "Visits: ER"
519        n_pc         = "Visits: PC"
520        n_tele       = "Visits: Tele"
521        n_total      = "Visits: Total in Monthly File"
522        pcmp_type    = "PCMP type, recoded"
523        pd_amt_pc    = "Cost: PC"
524        pd_amt_rx    = "Cost: Prescriptions"
525        pd_tele      = "Cost: Telehealth"
526        q            = "Quarter"
527        pd_amt_total = "Total FFS Cost of Care"
528        ;
529  RUN;

NOTE: Variable FY is uninitialized.
NOTE: There were 40999955 observations read from the data set DATA.ANALYTIC_DATASET.
NOTE: The data set DATA.ANALYTIC_DATASET has 40999955 observations and 45 variables.
NOTE: DATA statement used (Total process time):
      real time           4:15.00
      cpu time            21.45 seconds


