NOTE: PROCEDURE PRINTTO used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(HURDLE):   PROC GENMOD DATA = data.utilization;
MPRINT(HURDLE):   CLASS mcaid_id int(ref='0') int_imp(ref='0') budget_grp_new(ref='MAGI Eligible 
Children') race(ref='non-Hispanic White/Caucasian') sex(ref='Female') rae_person_new(ref='3') 
age_cat(ref='ages 21-44') fqhc(ref ='0') bh_oth17(ref='0') bh_oth18(ref='0') bh_oth19(ref='0') 
bh_er17(ref='0') bh_er18(ref='0') bh_er19(ref='0') bh_hosp17(ref='0') bh_hosp18(ref='0') 
bh_hosp19(ref='0') adj_pd_total_17cat(ref='0') adj_pd_total_18cat(ref='0') 
adj_pd_total_19cat(ref='0') ind_cost_pc;
MPRINT(HURDLE):   MODEL ind_cost_pc(event='1') = int int_imp time season1 season2 season3 
budget_grp_new race sex rae_person_new age_cat fqhc bh_oth17 bh_oth18 bh_oth19 bh_er17 bh_er18 
bh_er19 bh_hosp17 bh_hosp18 bh_hosp19 adj_pd_total_17cat adj_pd_total_18cat adj_pd_total_19cat / 
DIST=binomial;
MPRINT(HURDLE):   REPEATED SUBJECT = mcaid_id / type=exch ;
MPRINT(HURDLE):   store out.cost_pc_pmodel_exch;
MPRINT(HURDLE):   output out = predout pred = pred;
MPRINT(HURDLE):   run;

NOTE: Class levels for some variables were not printed due to excessive size.
NOTE: PROC GENMOD is modeling the probability that ind_cost_pc='1'. One way to change this to model 
      the probability that ind_cost_pc='0' is to specify the DESCENDING option in the PROC 
      statement.
NOTE: Algorithm converged.
NOTE: Algorithm converged.
NOTE: The GENMOD procedure generated the model item store OUT.COST_PC_PMODEL_EXCH.
NOTE: The data set WORK.PREDOUT has 19283171 observations and 41 variables.
NOTE: PROCEDURE GENMOD used (Total process time):
      real time           16:09.07
      cpu time            15:28.73
      

MPRINT(HURDLE):   TITLE 'Cost Model';
MPRINT(HURDLE):   PROC GENMOD DATA = data.utilization desc;
MPRINT(HURDLE):   WHERE cost_pc > 0;
MPRINT(HURDLE):   CLASS mcaid_id int(ref='0') int_imp(ref='0') budget_grp_new(ref='MAGI Eligible 
Children') race(ref='non-Hispanic White/Caucasian') sex(ref='Female') rae_person_new(ref='3') 
age_cat(ref='ages 21-44') fqhc(ref ='0') bh_oth17(ref='0') bh_oth18(ref='0') bh_oth19(ref='0') 
bh_er17(ref='0') bh_er18(ref='0') bh_er19(ref='0') bh_hosp17(ref='0') bh_hosp18(ref='0') 
bh_hosp19(ref='0') adj_pd_total_17cat(ref='0') adj_pd_total_18cat(ref='0') 
adj_pd_total_19cat(ref='0') ;
MPRINT(HURDLE):   MODEL cost_pc = int int_imp time season1 season2 season3 budget_grp_new race sex 
rae_person_new age_cat fqhc bh_oth17 bh_oth18 bh_oth19 bh_er17 bh_er18 bh_er19 bh_hosp17 bh_hosp18 
bh_hosp19 adj_pd_total_17cat adj_pd_total_18cat adj_pd_total_19cat / dist=gamma link=log ;
MPRINT(HURDLE):   REPEATED SUBJECT = mcaid_id / type = exch;
MPRINT(HURDLE):   store out.cost_pc_cmodel_exch;
MPRINT(HURDLE):   RUN;

NOTE: The DESCENDING option applies only to the multinomial distribution with ordinal response.
NOTE: Class levels for some variables were not printed due to excessive size.
NOTE: Algorithm converged.
NOTE: The GENMOD procedure deleted the model item store OUT.COST_PC_CMODEL_EXCH because of 
      incomplete information for a subsequent analysis.
NOTE: PROCEDURE GENMOD used (Total process time):
      real time           8:09.29
      cpu time            8:04.37
      

630  
631  
632  ** RESULTS ===================================;
633  %INCLUDE
633! "S:/FHPC/DATA/HCPF_DATA_files_SECURE/Kim/isp/isp_utilization/code/macro_results_visits.sas";
634  %results_visits(dv=visits_pc, visittype=pc);

635  LIBNAME tmp "S:/FHPC/DATA/HCPF_DATA_files_SECURE/Kim/isp/isp_utilization/data/out_tmp_nov";
NOTE: Libref TMP was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: S:\FHPC\DATA\HCPF_DATA_files_SECURE\Kim\isp\isp_utilization\data\out_tmp_nov

636  
637  * Subset to memlist specs before calculating (don't keep all the rae_ null, pcmp nulls,
637! managedCare=1 etc);
638  PROC SQL;
639  CREATE TABLE tmp.qrylong_post_1 AS
640  SELECT a.mcaid_id
641       , a.time
642       , b.*
643  FROM tmp.memlist AS A
644  LEFT JOIN tmp.qrylong_post_0 AS B on a.mcaid_id=b.mcaid_id AND a.time=b.time;
WARNING: Variable mcaid_id already exists on file TMP.QRYLONG_POST_1.
WARNING: Variable time already exists on file TMP.QRYLONG_POST_1.
NOTE: Table TMP.QRYLONG_POST_1 created, with 56899712 rows and 12 columns.

645  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:14.59
      cpu time            40.98 seconds
      

646  
647  PROC SQL;
647!           SELECT count(distinct mcaid_id) as n_un_ids from tmp.qrylong_post_1;
647!                                                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:00.39
      cpu time            7.17 seconds
      

648  
649  DATA tmp.qrylong_post_2 (KEEP = mcaid_id month time FY n_ed n_pc n_ffsbh n_tele adj_total
649! adj_pc adj_rx); /*removes dt_qrtr*/
650  SET  tmp.qrylong_post_1 ;
651  * Multiple the visit values by 6 to capture whole number values ;
652  ARRAY mult(*) n_ed n_pc n_ffsbh n_tele;
653  DO i=1 to dim(mult);
654  mult(i)=mult(i)*6;
655  END;
656  n_tele = coalesce(n_tele, 0);
657  RUN;

NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      128823237 at 654:16   
NOTE: There were 56899712 observations read from the data set TMP.QRYLONG_POST_1.
NOTE: The data set TMP.QRYLONG_POST_2 has 56899712 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           1:10.23
      cpu time            13.50 seconds
      

658  
659  PROC SQL;
660  CREATE TABLE tmp.qrylong_post_3 as
661  SELECT mcaid_id
662       , count(*) as n_months
663       , time
664       , FY
665       , avg(n_pc)       AS n_pc_pmpq
666       , avg(n_ed)       AS n_ed_pmpq
667       , avg(n_ffsbh)    AS n_ffsbh_pmpq
668       , avg(n_tele)     AS n_tel_pmpq
669       , avg(adj_total)  AS adj_total_pmpq
670       , avg(adj_pc)     AS adj_pc_pmpq
671       , avg(adj_rx)     AS adj_rx_pmpq
672  FROM tmp.qrylong_post_2
673  GROUP BY mcaid_id, time;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table TMP.QRYLONG_POST_3 created, with 56899712 rows and 11 columns.

674  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2:15.95
      cpu time            36.12 seconds
      

675  
676  PROC SORT DATA = tmp.qrylong_post_3 NODUPKEY OUT=tmp.qrylong_post_3; BY _ALL_; RUN;

NOTE: There were 56899712 observations read from the data set TMP.QRYLONG_POST_3.
NOTE: 37616541 observations with duplicate key values were deleted.
NOTE: The data set TMP.QRYLONG_POST_3 has 19283171 observations and 11 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           1:20.51
      cpu time            26.20 seconds
      

677  /*PROC FREQ DATA = tmp.qrylong_post_3; tables time; run; */
678  /*%check_ids_n16(in=tmp.qrylong_post_3, out=n_ids_post3); */
679  /*PROC SQL; Select count(distinct mcaid_id) as n_ids FROM tmp.qrylong_post_3; QUIT; */
680  /*PROC SQL; Select mcaid_id, time from tmp.qrylong_post_3  AS A*/
681  /*where not exists (select mcaid_id, time FROM tmp.final_04 AS B where a.mcaid_id=b.mcaid_id
681! and a.time=b.time); QUIT; */
682  
683  %macro pctl_2023(var, out, pctlpre, t_var);
684  PROC UNIVARIATE DATA = tmp.qrylong_post_3;
685  BY FY;
686  WHERE &VAR gt 0;
687  VAR   &VAR;
688  OUTPUT OUT=&out pctlpre=&pctlpre pctlpts=95;
689  RUN;
690  
691  PROC TRANSPOSE DATA = &out
692  OUT=&out._a (DROP   = _name_ _label_
693               RENAME = (col1 = &t_var.p_20
694                         col2 = &t_var.p_21
695                         col3 = &t_var.p_22
696                         col4 = &t_var.p_23));
697  var &t_var ;
698  RUN;
699  %mend;
700  
701  PROC SORT DATA = tmp.qrylong_post_3; BY FY; RUN;

NOTE: There were 19283171 observations read from the data set TMP.QRYLONG_POST_3.
NOTE: The data set TMP.QRYLONG_POST_3 has 19283171 observations and 11 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           43.44 seconds
      cpu time            9.31 seconds
      

702  
703  %pctl_2023(var = adj_total_pmpq,   out = tmp.adj_total_pctl,   pctlpre = adj_total_,  t_var =
703! adj_total_95);
MLOGIC(PCTL_2023):  Beginning execution.
MLOGIC(PCTL_2023):  Parameter VAR has value adj_total_pmpq
MLOGIC(PCTL_2023):  Parameter OUT has value tmp.adj_total_pctl
MLOGIC(PCTL_2023):  Parameter PCTLPRE has value adj_total_
MLOGIC(PCTL_2023):  Parameter T_VAR has value adj_total_95
MPRINT(PCTL_2023):   PROC UNIVARIATE DATA = tmp.qrylong_post_3;
MPRINT(PCTL_2023):   BY FY;
MPRINT(PCTL_2023):   WHERE adj_total_pmpq gt 0;
MPRINT(PCTL_2023):   VAR adj_total_pmpq;
MPRINT(PCTL_2023):   OUTPUT OUT=tmp.adj_total_pctl pctlpre=adj_total_ pctlpts=95;
MPRINT(PCTL_2023):   RUN;

NOTE: The data set TMP.ADJ_TOTAL_PCTL has 4 observations and 2 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           31.73 seconds
      cpu time            16.39 seconds
      

MPRINT(PCTL_2023):   PROC TRANSPOSE DATA = tmp.adj_total_pctl OUT=tmp.adj_total_pctl_a (DROP = 
_name_ _label_ RENAME = (col1 = adj_total_95p_20 col2 = adj_total_95p_21 col3 = adj_total_95p_22 
col4 = adj_total_95p_23));
MPRINT(PCTL_2023):   var adj_total_95 ;
MPRINT(PCTL_2023):   RUN;

NOTE: There were 4 observations read from the data set TMP.ADJ_TOTAL_PCTL.
NOTE: The data set TMP.ADJ_TOTAL_PCTL_A has 1 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.20 seconds
      cpu time            0.01 seconds
      

MLOGIC(PCTL_2023):  Ending execution.
704  %pctl_2023(var = adj_pc_pmpq,      out = tmp.adj_pc_pctl,      pctlpre = adj_pc_,     t_var =
704! adj_pc_95);
MLOGIC(PCTL_2023):  Beginning execution.
MLOGIC(PCTL_2023):  Parameter VAR has value adj_pc_pmpq
MLOGIC(PCTL_2023):  Parameter OUT has value tmp.adj_pc_pctl
MLOGIC(PCTL_2023):  Parameter PCTLPRE has value adj_pc_
MLOGIC(PCTL_2023):  Parameter T_VAR has value adj_pc_95
MPRINT(PCTL_2023):   PROC UNIVARIATE DATA = tmp.qrylong_post_3;
MPRINT(PCTL_2023):   BY FY;
MPRINT(PCTL_2023):   WHERE adj_pc_pmpq gt 0;
MPRINT(PCTL_2023):   VAR adj_pc_pmpq;
MPRINT(PCTL_2023):   OUTPUT OUT=tmp.adj_pc_pctl pctlpre=adj_pc_ pctlpts=95;
MPRINT(PCTL_2023):   RUN;

NOTE: The data set TMP.ADJ_PC_PCTL has 4 observations and 2 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           7.64 seconds
      cpu time            7.46 seconds
      

MPRINT(PCTL_2023):   PROC TRANSPOSE DATA = tmp.adj_pc_pctl OUT=tmp.adj_pc_pctl_a (DROP = _name_ 
_label_ RENAME = (col1 = adj_pc_95p_20 col2 = adj_pc_95p_21 col3 = adj_pc_95p_22 col4 = 
adj_pc_95p_23));
MPRINT(PCTL_2023):   var adj_pc_95 ;
MPRINT(PCTL_2023):   RUN;

NOTE: There were 4 observations read from the data set TMP.ADJ_PC_PCTL.
NOTE: The data set TMP.ADJ_PC_PCTL_A has 1 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.19 seconds
      cpu time            0.01 seconds
      

MLOGIC(PCTL_2023):  Ending execution.
705  %pctl_2023(var = adj_rx_pmpq,      out = tmp.adj_rx_pctl,      pctlpre = adj_rx_,     t_var =
705! adj_rx_95);
MLOGIC(PCTL_2023):  Beginning execution.
MLOGIC(PCTL_2023):  Parameter VAR has value adj_rx_pmpq
MLOGIC(PCTL_2023):  Parameter OUT has value tmp.adj_rx_pctl
MLOGIC(PCTL_2023):  Parameter PCTLPRE has value adj_rx_
MLOGIC(PCTL_2023):  Parameter T_VAR has value adj_rx_95
MPRINT(PCTL_2023):   PROC UNIVARIATE DATA = tmp.qrylong_post_3;
MPRINT(PCTL_2023):   BY FY;
MPRINT(PCTL_2023):   WHERE adj_rx_pmpq gt 0;
MPRINT(PCTL_2023):   VAR adj_rx_pmpq;
MPRINT(PCTL_2023):   OUTPUT OUT=tmp.adj_rx_pctl pctlpre=adj_rx_ pctlpts=95;
MPRINT(PCTL_2023):   RUN;

NOTE: The data set TMP.ADJ_RX_PCTL has 4 observations and 2 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           7.63 seconds
      cpu time            7.40 seconds
      

MPRINT(PCTL_2023):   PROC TRANSPOSE DATA = tmp.adj_rx_pctl OUT=tmp.adj_rx_pctl_a (DROP = _name_ 
_label_ RENAME = (col1 = adj_rx_95p_20 col2 = adj_rx_95p_21 col3 = adj_rx_95p_22 col4 = 
adj_rx_95p_23));
MPRINT(PCTL_2023):   var adj_rx_95 ;
MPRINT(PCTL_2023):   RUN;

NOTE: There were 4 observations read from the data set TMP.ADJ_RX_PCTL.
NOTE: The data set TMP.ADJ_RX_PCTL_A has 1 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.19 seconds
      cpu time            0.03 seconds
      

MLOGIC(PCTL_2023):  Ending execution.
706  
707  data tmp.pctl2023; merge tmp.adj_total_pctl_a tmp.adj_pc_pctl_a tmp.adj_rx_pctl_a ; run;

NOTE: There were 1 observations read from the data set TMP.ADJ_TOTAL_PCTL_A.
NOTE: There were 1 observations read from the data set TMP.ADJ_PC_PCTL_A.
NOTE: There were 1 observations read from the data set TMP.ADJ_RX_PCTL_A.
NOTE: The data set TMP.PCTL2023 has 1 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.20 seconds
      cpu time            0.03 seconds
      

708  
709  PROC PRINT DATA = tmp.pctl2023; RUN;

NOTE: There were 1 observations read from the data set TMP.PCTL2023.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

710  PROC PRINT DATA = tmp.adj_total_pctl;

NOTE: There were 4 observations read from the data set TMP.ADJ_TOTAL_PCTL.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

711  PROC PRINT DATA = tmp.adj_pc_pctl;

NOTE: There were 4 observations read from the data set TMP.ADJ_PC_PCTL.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

712  PROC PRINT DATA = tmp.adj_rx_pctl; RUN;

NOTE: There were 4 observations read from the data set TMP.ADJ_RX_PCTL.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

713  
714  *
714! https://stackoverflow.com/questions/60097941/sas-calculate-percentiles-and-save-to-macro-variab
714! le;
715  proc sql noprint;
716    select name, cats(':',name)
717    into
718      :COL_NAMES separated by ',',
719      :MVAR_NAMES separated by ','
720    from sashelp.vcolumn
721    where libname = "TMP"
722      and memname = "PCTL2023";
723    select &COL_NAMES into &MVAR_NAMES
724    from tmp.pctl2023;
725  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

726  
727  %put &col_names &mvar_names;
adj_total_95p_20,adj_total_95p_21,adj_total_95p_22,adj_total_95p_23,adj_pc_95p_20,adj_pc_95p_21,adj_
pc_95p_22,adj_pc_95p_23,adj_rx_95p_20,adj_rx_95p_21,adj_rx_95p_22,adj_rx_95p_23 
:adj_total_95p_20,:adj_total_95p_21,:adj_total_95p_22,:adj_total_95p_23,:adj_pc_95p_20,:adj_pc_95p_2
1,:adj_pc_95p_22,:adj_pc_95p_23,:adj_rx_95p_20,:adj_rx_95p_21,:adj_rx_95p_22,:adj_rx_95p_23
728  
729  * Get mean where value gt 95th pctl value;
730  %MACRO means_95p(fy=,var=,gt=,out=,mean=);
731  PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
732  WHERE FY=&FY
733  AND   &VAR gt &gt;
734  VAR   &VAR;
735  OUTPUT OUT=&out MEAN=&mean; RUN;
736  %MEND;
737  
738  * tried with proc means to compare to macro and got exact same results;
739  %means_95p(FY=2020, var=adj_total_pmpq, gt=&adj_total_95p_20, out=mu_total_20, MEAN=Mu_total20)
739! ;
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2020
MLOGIC(MEANS_95P):  Parameter VAR has value adj_total_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 3973.617
MLOGIC(MEANS_95P):  Parameter OUT has value mu_total_20
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_total20
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2020 AND adj_total_pmpq gt 3973.617;
MPRINT(MEANS_95P):   VAR adj_total_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_total_20 MEAN=Mu_total20;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_TOTAL_20 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.29 seconds
      cpu time            0.28 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
740  %means_95p(FY=2021, var=adj_total_pmpq, gt=&adj_total_95p_21, out=mu_total_21, MEAN=Mu_total21)
740! ;
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2021
MLOGIC(MEANS_95P):  Parameter VAR has value adj_total_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 3739.529
MLOGIC(MEANS_95P):  Parameter OUT has value mu_total_21
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_total21
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2021 AND adj_total_pmpq gt 3739.529;
MPRINT(MEANS_95P):   VAR adj_total_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_total_21 MEAN=Mu_total21;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_TOTAL_21 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.46 seconds
      cpu time            0.45 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
741  %means_95p(FY=2022, var=adj_total_pmpq, gt=&adj_total_95p_22, out=mu_total_22, MEAN=Mu_total22)
741! ;
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2022
MLOGIC(MEANS_95P):  Parameter VAR has value adj_total_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 3652.103
MLOGIC(MEANS_95P):  Parameter OUT has value mu_total_22
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_total22
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2022 AND adj_total_pmpq gt 3652.103;
MPRINT(MEANS_95P):   VAR adj_total_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_total_22 MEAN=Mu_total22;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_TOTAL_22 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.62 seconds
      cpu time            0.60 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
742  %means_95p(FY=2023, var=adj_total_pmpq, gt=&adj_total_95p_23, out=mu_total_23, MEAN=Mu_total23)
742! ;
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2023
MLOGIC(MEANS_95P):  Parameter VAR has value adj_total_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 3990.357
MLOGIC(MEANS_95P):  Parameter OUT has value mu_total_23
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_total23
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2023 AND adj_total_pmpq gt 3990.357;
MPRINT(MEANS_95P):   VAR adj_total_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_total_23 MEAN=Mu_total23;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_TOTAL_23 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.81 seconds
      cpu time            0.79 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
743  
744  %means_95p(FY=2020, var=adj_pc_pmpq,    gt=&adj_pc_95p_20,    out=mu_pc_20,    MEAN=Mu_pc20);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2020
MLOGIC(MEANS_95P):  Parameter VAR has value adj_pc_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 361.7198
MLOGIC(MEANS_95P):  Parameter OUT has value mu_pc_20
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_pc20
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2020 AND adj_pc_pmpq gt 361.7198;
MPRINT(MEANS_95P):   VAR adj_pc_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_pc_20 MEAN=Mu_pc20;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_PC_20 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.23 seconds
      cpu time            0.23 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
745  %means_95p(FY=2021, var=adj_pc_pmpq,    gt=&adj_pc_95p_21,    out=mu_pc_21,    MEAN=Mu_pc21);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2021
MLOGIC(MEANS_95P):  Parameter VAR has value adj_pc_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 348.5533
MLOGIC(MEANS_95P):  Parameter OUT has value mu_pc_21
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_pc21
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2021 AND adj_pc_pmpq gt 348.5533;
MPRINT(MEANS_95P):   VAR adj_pc_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_pc_21 MEAN=Mu_pc21;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_PC_21 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.38 seconds
      cpu time            0.37 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
746  %means_95p(FY=2022, var=adj_pc_pmpq,    gt=&adj_pc_95p_22,    out=mu_pc_22,    MEAN=Mu_pc22);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2022
MLOGIC(MEANS_95P):  Parameter VAR has value adj_pc_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 339.1625
MLOGIC(MEANS_95P):  Parameter OUT has value mu_pc_22
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_pc22
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2022 AND adj_pc_pmpq gt 339.1625;
MPRINT(MEANS_95P):   VAR adj_pc_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_pc_22 MEAN=Mu_pc22;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_PC_22 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.55 seconds
      cpu time            0.56 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
747  %means_95p(FY=2023, var=adj_pc_pmpq,    gt=&adj_pc_95p_23,    out=mu_pc_23,    MEAN=Mu_pc23);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2023
MLOGIC(MEANS_95P):  Parameter VAR has value adj_pc_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 331.2719
MLOGIC(MEANS_95P):  Parameter OUT has value mu_pc_23
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_pc23
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2023 AND adj_pc_pmpq gt 331.2719;
MPRINT(MEANS_95P):   VAR adj_pc_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_pc_23 MEAN=Mu_pc23;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_PC_23 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.75 seconds
      cpu time            0.73 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
748  
749  %means_95p(FY=2020, var=adj_rx_pmpq,    gt=&adj_rx_95p_20,    out=mu_rx_20,    MEAN=Mu_rx20);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2020
MLOGIC(MEANS_95P):  Parameter VAR has value adj_rx_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 1076.364
MLOGIC(MEANS_95P):  Parameter OUT has value mu_rx_20
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_rx20
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2020 AND adj_rx_pmpq gt 1076.364;
MPRINT(MEANS_95P):   VAR adj_rx_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_rx_20 MEAN=Mu_rx20;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_RX_20 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.22 seconds
      cpu time            0.21 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
750  %means_95p(FY=2021, var=adj_rx_pmpq,    gt=&adj_rx_95p_21,    out=mu_rx_21,    MEAN=Mu_rx21);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2021
MLOGIC(MEANS_95P):  Parameter VAR has value adj_rx_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 1151.569
MLOGIC(MEANS_95P):  Parameter OUT has value mu_rx_21
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_rx21
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2021 AND adj_rx_pmpq gt 1151.569;
MPRINT(MEANS_95P):   VAR adj_rx_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_rx_21 MEAN=Mu_rx21;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_RX_21 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.37 seconds
      cpu time            0.37 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
751  %means_95p(FY=2022, var=adj_rx_pmpq,    gt=&adj_rx_95p_22,    out=mu_rx_22,    MEAN=Mu_rx22);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2022
MLOGIC(MEANS_95P):  Parameter VAR has value adj_rx_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 1163.092
MLOGIC(MEANS_95P):  Parameter OUT has value mu_rx_22
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_rx22
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2022 AND adj_rx_pmpq gt 1163.092;
MPRINT(MEANS_95P):   VAR adj_rx_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_rx_22 MEAN=Mu_rx22;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_RX_22 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.56 seconds
      cpu time            0.56 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
752  %means_95p(FY=2023, var=adj_rx_pmpq,    gt=&adj_rx_95p_23,    out=mu_rx_23,    MEAN=Mu_rx23);
MLOGIC(MEANS_95P):  Beginning execution.
MLOGIC(MEANS_95P):  Parameter FY has value 2023
MLOGIC(MEANS_95P):  Parameter VAR has value adj_rx_pmpq
MLOGIC(MEANS_95P):  Parameter GT has value 1205.746
MLOGIC(MEANS_95P):  Parameter OUT has value mu_rx_23
MLOGIC(MEANS_95P):  Parameter MEAN has value Mu_rx23
MPRINT(MEANS_95P):   PROC UNIVARIATE NOPRINT DATA = tmp.qrylong_post_3;
MPRINT(MEANS_95P):   WHERE FY=2023 AND adj_rx_pmpq gt 1205.746;
MPRINT(MEANS_95P):   VAR adj_rx_pmpq;
MPRINT(MEANS_95P):   OUTPUT OUT=mu_rx_23 MEAN=Mu_rx23;
MPRINT(MEANS_95P):   RUN;

NOTE: The data set WORK.MU_RX_23 has 1 observations and 1 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.75 seconds
      cpu time            0.76 seconds
      

MLOGIC(MEANS_95P):  Ending execution.
753  
754  data tmp.mu_pctl_2023;
755  merge mu_total_20       mu_total_21     mu_total_22     mu_total_23
756        mu_pc_20          mu_pc_21        mu_pc_22        mu_pc_23
757        mu_rx_20          mu_rx_21        mu_rx_22        mu_rx_23
758        tmp.adj_total_pctl_a  tmp.adj_pc_pctl_a   tmp.adj_rx_pctl_a;
759  RUN;

NOTE: There were 1 observations read from the data set WORK.MU_TOTAL_20.
NOTE: There were 1 observations read from the data set WORK.MU_TOTAL_21.
NOTE: There were 1 observations read from the data set WORK.MU_TOTAL_22.
NOTE: There were 1 observations read from the data set WORK.MU_TOTAL_23.
NOTE: There were 1 observations read from the data set WORK.MU_PC_20.
NOTE: There were 1 observations read from the data set WORK.MU_PC_21.
NOTE: There were 1 observations read from the data set WORK.MU_PC_22.
NOTE: There were 1 observations read from the data set WORK.MU_PC_23.
NOTE: There were 1 observations read from the data set WORK.MU_RX_20.
NOTE: There were 1 observations read from the data set WORK.MU_RX_21.
NOTE: There were 1 observations read from the data set WORK.MU_RX_22.
NOTE: There were 1 observations read from the data set WORK.MU_RX_23.
NOTE: There were 1 observations read from the data set TMP.ADJ_TOTAL_PCTL_A.
NOTE: There were 1 observations read from the data set TMP.ADJ_PC_PCTL_A.
NOTE: There were 1 observations read from the data set TMP.ADJ_RX_PCTL_A.
NOTE: The data set TMP.MU_PCTL_2023 has 1 observations and 24 variables.
NOTE: DATA statement used (Total process time):
      real time           0.18 seconds
      cpu time            0.03 seconds
      

760  PROC PRINT DATA = tmp.mu_pctl_2023; RUN;

NOTE: There were 1 observations read from the data set TMP.MU_PCTL_2023.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

761  
762  proc sql noprint;
763    select name, cats(':',name)
764    into
765      :COL_NAMES separated by ',',
766      :MVAR_NAMES separated by ','
767    from sashelp.vcolumn
768    where libname = "TMP"
769      and memname = "MU_PCTL_2023";
770    select &COL_NAMES into &MVAR_NAMES
771    from tmp.mu_pctl_2023;
772  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

773  
774  DATA tmp.qrylong_post_4;
775  SET  tmp.qrylong_post_3;
776  
777  * replace values >95p with mu95;
778  IF      FY = 2020 AND adj_total_pmpq gt &adj_total_95p_20 THEN adj_pd_total_tc = &mu_total20;
779  ELSE IF FY = 2021 AND adj_total_pmpq gt &adj_total_95p_21 THEN adj_pd_total_tc = &mu_total21;
780  ELSE IF FY = 2022 AND adj_total_pmpq gt &adj_total_95p_22 THEN adj_pd_total_tc = &mu_total22;
781  ELSE IF FY = 2023 AND adj_total_pmpq gt &adj_total_95p_23 THEN adj_pd_total_tc = &mu_total23;
782  ELSE adj_pd_total_tc= adj_total_pmpq;
783  
784  IF      FY = 2020 AND adj_pc_pmpq    gt &adj_pc_95p_20    THEN adj_pd_pc_tc    = &mu_pc20;
785  ELSE IF FY = 2021 AND adj_pc_pmpq    gt &adj_pc_95p_21    THEN adj_pd_pc_tc    = &mu_pc21;
786  ELSE IF FY = 2022 AND adj_pc_pmpq    gt &adj_pc_95p_22    THEN adj_pd_pc_tc    = &mu_pc22;
787  ELSE IF FY = 2023 AND adj_pc_pmpq    gt &adj_pc_95p_23    THEN adj_pd_pc_tc    = &mu_pc23;
788  ELSE adj_pd_pc_tc= adj_pc_pmpq;
789  
790  IF      FY = 2020 AND adj_rx_pmpq    gt &adj_rx_95p_20    THEN adj_pd_rx_tc    = &mu_rx20;
791  ELSE IF FY = 2021 AND adj_rx_pmpq    gt &adj_rx_95p_21    THEN adj_pd_rx_tc    = &mu_rx21;
792  ELSE IF FY = 2022 AND adj_rx_pmpq    gt &adj_rx_95p_22    THEN adj_pd_rx_tc    = &mu_rx22;
793  ELSE IF FY = 2023 AND adj_rx_pmpq    gt &adj_rx_95p_23    THEN adj_pd_rx_tc    = &mu_rx23;
794  ELSE adj_pd_rx_tc= adj_rx_pmpq;
795  RUN;

NOTE: There were 19283171 observations read from the data set TMP.QRYLONG_POST_3.
NOTE: The data set TMP.QRYLONG_POST_4 has 19283171 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           30.28 seconds
      cpu time            3.46 seconds
      

796  
797  * [tmp.FINAL_05];
798  PROC SQL;
799  CREATE TABLE tmp.final_05 AS
800  SELECT a.*
801       , b.*
802       , c.fqhc
803  FROM tmp.final_04            AS A
804  LEFT JOIN tmp.qrylong_post_4 AS B ON a.mcaid_id=b.mcaid_id AND a.time=b.time
805  LEFT JOIN tmp.pcmp_dim       AS C ON a.pcmp_loc_id=c.pcmp_loc_id;
WARNING: Variable mcaid_id already exists on file TMP.FINAL_05.
WARNING: Variable time already exists on file TMP.FINAL_05.
WARNING: Variable FY already exists on file TMP.FINAL_05.
NOTE: Table TMP.FINAL_05 created, with 19283171 rows and 42 columns.

806  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:22.91
      cpu time            52.18 seconds
      

807  
808  * [tmp.FINAL_06]===============================================================
809  * setting to 0 where . for variables not using elig category (adj 16-18 vars)
810  Create indicator variables for DV's where >0 (use when creating pctiles or just in gee but
810! needed eventually anyway);
811  
812  DATA tmp.final_06 (DROP = dt_qrtr );
813  * Not yet setting length for time and mcaid_id bc they might get joined later;
814  LENGTH FY age_cat budget_group rae_person_new int int_imp 3. sex $1. ;
815  SET  tmp.final_05 (DROP = adj_rx_pmpq adj_pc_pmpq adj_total_pmpq n_months);
816  
817  ARRAY dv(*) bho_n_hosp_17pm     bho_n_hosp_18pm     bho_n_hosp_19pm
818              bho_n_er_17pm       bho_n_er_18pm       bho_n_er_19pm
819              bho_n_other_17pm    bho_n_other_18pm    bho_n_other_19pm
820              n_pc_pmpq           n_ed_pmpq           n_ffsbh_pmpq     n_tel_pmpq
821              adj_pd_total_tc     adj_pd_pc_tc        adj_pd_rx_tc;
822  
823  DO i=1 to dim(dv);
824      IF dv(i)=. THEN dv(i)=0;
825      ELSE dv(i)=dv(i);
826      END;
827  DROP i;
828  
829  * adj vars for 17-19cat, if not in ds then set to -1;
830  adj_pd_total_17cat = coalesce(adj_pd_total_17cat, -1);
831  adj_pd_total_18cat = coalesce(adj_pd_total_18cat, -1);
832  adj_pd_total_19cat = coalesce(adj_pd_total_19cat, -1);
833  
834  ind_visit_pc    = n_pc_pmpq       > 0;
835  ind_visit_ed    = n_ed_pmpq       > 0;
836  ind_visit_ffsbh = n_ffsbh_pmpq    > 0;
837  ind_visit_tel   = n_tel_pmpq      > 0;
838  ind_cost_total  = adj_pd_total_tc > 0;
839  ind_cost_pc     = adj_pd_pc_tc    > 0;
840  ind_cost_rx     = adj_pd_rx_tc    > 0;
841  RUN;

WARNING: Multiple lengths were specified for the variable FY by input data set(s). This can cause 
         truncation of data.
WARNING: Multiple lengths were specified for the variable sex by input data set(s). This can cause 
         truncation of data.
WARNING: Multiple lengths were specified for the variable age_cat by input data set(s). This can 
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable budget_group by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable rae_person_new by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable int by input data set(s). This can cause 
         truncation of data.
WARNING: Multiple lengths were specified for the variable int_imp by input data set(s). This can 
         cause truncation of data.
NOTE: There were 19283171 observations read from the data set TMP.FINAL_05.
NOTE: The data set TMP.FINAL_06 has 19283171 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           2:21.20
      cpu time            10.54 seconds
      

841!       *19238171, 44 vars;
842  
843  PROC FREQ DATA = tmp.final_06; tables adj_pd_total_1: elig: ; RUN;

NOTE: There were 19283171 observations read from the data set TMP.FINAL_06.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           1:06.54
      cpu time            2.57 seconds
      

844  PROC MEANS DATA = tmp.final_06 nmiss; RUN;

NOTE: There were 19283171 observations read from the data set TMP.FINAL_06.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           5.05 seconds
      cpu time            22.03 seconds
      

845  PROC FREQ DATA = tmp.final_06; TABLES adj_pd_total_17cat*elig2017; RUN;

NOTE: There were 19283171 observations read from the data set TMP.FINAL_06.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           2.35 seconds
      cpu time            2.31 seconds
      

846  PROC FREQ DATA = tmp.final_06; TABLES adj_pd_total_18cat*elig2018; RUN;

NOTE: There were 19283171 observations read from the data set TMP.FINAL_06.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           2.38 seconds
      cpu time            2.35 seconds
      

847  PROC FREQ DATA = tmp.final_06; TABLES adj_pd_total_19cat*elig2019; RUN;

NOTE: There were 19283171 observations read from the data set TMP.FINAL_06.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           2.37 seconds
      cpu time            2.35 seconds
      

848  
849  * ANALYSIS_DATASET_ALLCOLS ==================================================================
850  ===========================================================================================;
851  *** Add quarter variables, one with text for readability ;
852  DATA tmp.final_07 ;
853  SET  tmp.final_06 (RENAME=(bho_n_hosp_17pm  = BH_Hosp17
854                             bho_n_hosp_18pm  = BH_Hosp18
855                             bho_n_hosp_19pm  = BH_Hosp19
856                             bho_n_er_17pm    = BH_ER17
857                             bho_n_er_18pm    = BH_ER18
858                             bho_n_er_19pm    = BH_ER19
859                             bho_n_other_17pm = BH_Oth17
860                             bho_n_other_18pm = BH_Oth18
861                             bho_n_other_19pm = BH_Oth19));
862  * make binary;
863  ARRAY bh(*) BH_Hosp17 BH_Hosp18 BH_Hosp19 BH_ER17 BH_ER18 BH_ER19 BH_Oth17 BH_Oth18 BH_Oth19;
864  DO i=1 to dim(bh); IF bh(i)>0 THEN bh(i)=1; ELSE bh(i)=bh(i); END; DROP i;
865  
866  fyqrtr     = input(time, fyqrtr_num.);
867  IF fyqrtr  = 1 THEN season1 = 1; ELSE IF fyqrtr = 4 THEN season1 = -1; ELSE season1 = 0;
868  IF fyqrtr  = 2 THEN season2 = 1; ELSE IF fyqrtr = 4 THEN season2 = -1; ELSE season2 = 0;
869  IF fyqrtr  = 3 THEN season3 = 1; ELSE IF fyqrtr = 4 THEN season3 = -1; ELSE season3 = 0;
870  
871  * rescale from 0-6 instead of -1 to 5;
872  adj_pd_total_17cat = adj_pd_total_17cat + 1;
873  adj_pd_total_18cat = adj_pd_total_18cat + 1;
874  adj_pd_total_19cat = adj_pd_total_19cat + 1;
875  
876  RUN;

NOTE: Numeric values have been converted to character values at the places given by: 
      (Line):(Column).
      866:20   
NOTE: There were 19283171 observations read from the data set TMP.FINAL_06.
NOTE: The data set TMP.FINAL_07 has 19283171 observations and 48 variables.
NOTE: DATA statement used (Total process time):
      real time           1:22.59
      cpu time            13.51 seconds
      

877  
878  PROC SORT DATA = tmp.final_07; BY mcaid_id time; RUN;

NOTE: There were 19283171 observations read from the data set TMP.FINAL_07.
NOTE: The data set TMP.FINAL_07 has 19283171 observations and 48 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           2:48.82
      cpu time            21.26 seconds
      

879  PROC CONTENTS DATA = tmp.final_07 VARNUM; RUN;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.06 seconds
      cpu time            0.03 seconds
      

880  * DATA.ANALYSIS ===========================================================================;
881  %INCLUDE "S:/FHPC/DATA/HCPF_DATA_files_SECURE/Kim/isp/isp_utilization/code/config_formats.sas";
NOTE: Format FYQRTR_CAT is already on the library DATA.FORMATS.
NOTE: Format FYQRTR_CAT has been written to DATA.FORMATS.
NOTE: Informat FYQRTR_NUM is already on the library DATA.FORMATS.
NOTE: Informat FYQRTR_NUM has been output.
NOTE: Format BUDGET_GRP_R is already on the library DATA.FORMATS.
NOTE: Format BUDGET_GRP_R has been written to DATA.FORMATS.
NOTE: Format BUDGET_GRP_NEW_ is already on the library DATA.FORMATS.
NOTE: Format BUDGET_GRP_NEW_ has been written to DATA.FORMATS.
NOTE: Format BUDGET_GROUP_RC_ is already on the library DATA.FORMATS.
NOTE: Format BUDGET_GROUP_RC_ has been written to DATA.FORMATS.
NOTE: Format $RACE_RC_ is already on the library DATA.FORMATS.
NOTE: Format $RACE_RC_ has been written to DATA.FORMATS.
NOTE: Format AGE_CAT_ is already on the library DATA.FORMATS.
NOTE: Format AGE_CAT_ has been written to DATA.FORMATS.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

967   
968   * Numeric vars that can be set to length=3 to reduce dataset in tmp.final_08 step ;
969   %LET len08 = time fqhc season1 season2 season3 adj_pd_total_17cat adj_pd_total_18cat
969 ! adj_pd_total_19cat
970                ind_visit_pc ind_visit_ed ind_visit_ffsbh ind_visit_tel ind_cost_total
970 ! ind_cost_pc ind_cost_rx;
971   
972   DATA   data.utilization_large_nov;
973   LENGTH &len08 3 pcmp_loc_id 4;
974   SET    tmp.final_07;
975   
976   budget_grp_r = input(put(budget_group, budget_grp_r.), 12.);
977   FORMAT budget_grp_r budget_grp_new_. race $race_rc_. age_cat age_cat_.;
978   
979   RUN;

WARNING: Multiple lengths were specified for the variable time by input data set(s). This can cause 
         truncation of data.
WARNING: Multiple lengths were specified for the variable pcmp_loc_id by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable adj_pd_total_17cat by input data set(s). 
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable adj_pd_total_18cat by input data set(s). 
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable adj_pd_total_19cat by input data set(s). 
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable fqhc by input data set(s). This can cause 
         truncation of data.
WARNING: Multiple lengths were specified for the variable ind_visit_pc by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ind_visit_ed by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ind_visit_ffsbh by input data set(s). 
         This can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ind_visit_tel by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ind_cost_total by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ind_cost_pc by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable ind_cost_rx by input data set(s). This 
         can cause truncation of data.
WARNING: Multiple lengths were specified for the variable season1 by input data set(s). This can 
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable season2 by input data set(s). This can 
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable season3 by input data set(s). This can 
         cause truncation of data.
NOTE: There were 19283171 observations read from the data set TMP.FINAL_07.
NOTE: The data set DATA.UTILIZATION_LARGE_NOV has 19283171 observations and 49 variables.
NOTE: DATA statement used (Total process time):
      real time           2:07.11
      cpu time            7.21 seconds
      

980   
981   PROC CONTENTS DATA = data.utilization_large_nov VARNUM; RUN;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.05 seconds
      cpu time            0.01 seconds
      

982   
983   *[DATA.UTILIZATION];
984   %LET retain = mcaid_id time int int_imp season1 season2 season3 ind_cost_total cost_total
984 ! ind_cost_pc cost_pc ind_cost_rx cost_rx
985                 adj_pd_total_17cat adj_pd_total_18cat adj_pd_total_19cat
986                 ind_visit_pc visits_pc ind_visit_ed visits_ed ind_visit_ffsbh visits_ffsbh
986 ! ind_visit_tel visits_tel
987                 bh_hosp17 bh_hosp18 bh_hosp19 bh_er17 bh_er18 bh_er19 bh_oth17 bh_oth18 bh_oth19
988                 fqhc budget_grp_new age_cat rae_person_new  race sex pcmp_loc_id;
989   
990   %LET keep = mcaid_id time int int_imp season1 season2 season3 ind_cost_total adj_pd_total_tc
990 ! ind_cost_pc adj_pd_pc_tc ind_cost_rx adj_pd_rx_tc
991               adj_pd_total_17cat adj_pd_total_18cat adj_pd_total_19cat
992               ind_visit_pc n_pc_pmpq ind_visit_ed n_ed_pmpq ind_visit_ffsbh n_ffsbh_pmpq
992 ! ind_visit_tel n_tel_pmpq
993               bh_hosp17 bh_hosp18 bh_hosp19 bh_er17 bh_er18 bh_er19 bh_oth17 bh_oth18 bh_oth19
994               fqhc budget_grp_r age_cat rae_person_new  race sex pcmp_loc_id;
995   * previous version had 39 cols;
996   DATA data.utilization ;
997   RETAIN &retain;
998   LENGTH budget_grp_new age_cat 3. mcaid_id $7. sex $1.;
999   SET    data.utilization_large_nov
1000         (RENAME=(adj_pd_total_tc = cost_total
1001                  adj_pd_pc_tc    = cost_pc
1002                  adj_pd_rx_tc    = cost_rx
1003                  n_pc_pmpq       = visits_pc
1004                  n_ed_pmpq       = visits_ed
1005                  n_ffsbh_pmpq    = visits_ffsbh
1006                  n_tel_pmpq      = visits_tel
1007                  budget_grp_r    = budget_grp_new)
1008         KEEP= &keep);
1009  RUN;

WARNING: Multiple lengths were specified for the variable mcaid_id by input data set(s). This can 
         cause truncation of data.
WARNING: Multiple lengths were specified for the variable budget_grp_new by input data set(s). This 
         can cause truncation of data.
NOTE: There were 19283171 observations read from the data set DATA.UTILIZATION_LARGE_NOV.
NOTE: The data set DATA.UTILIZATION has 19283171 observations and 40 variables.
NOTE: DATA statement used (Total process time):
      real time           1:41.16
      cpu time            5.50 seconds
      

1010  
1011  /**/
1012  /*** CREATE META DS  ====================================;*/
1013  PROC SQL;
1014  CREATE TABLE data.UTILIZATION_meta AS
1015  SELECT name as variable
1016       , type
1017       , length
1018       , label
1019       , format
1020       , informat
1021  FROM sashelp.vcolumn
1022  WHERE LIBNAME = 'DATA'
1023  AND   MEMNAME = 'UTILIZATION';
NOTE: Table DATA.UTILIZATION_META created, with 40 rows and 6 columns.

1024  quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.27 seconds
      cpu time            0.04 seconds
      

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           58:12.73
      cpu time            29:05.23
      
NOTE: PROCEDURE PRINTTO used (Total process time):
      real time           0.06 seconds
      cpu time            0.00 seconds
      

MPRINT(HURDLE):   PROC GENMOD DATA = data.utilization;
MPRINT(HURDLE):   CLASS mcaid_id int(ref='0') int_imp(ref='0') budget_grp_new(ref='MAGI Eligible 
Children') race(ref='non-Hispanic White/Caucasian') sex(ref='Female') rae_person_new(ref='3') 
age_cat(ref='ages 21-44') fqhc(ref ='0') bh_oth17(ref='0') bh_oth18(ref='0') bh_oth19(ref='0') 
bh_er17(ref='0') bh_er18(ref='0') bh_er19(ref='0') bh_hosp17(ref='0') bh_hosp18(ref='0') 
bh_hosp19(ref='0') adj_pd_total_17cat(ref='0') adj_pd_total_18cat(ref='0') 
adj_pd_total_19cat(ref='0') ind_cost_pc;
MPRINT(HURDLE):   MODEL ind_cost_pc(event='1') = int int_imp time season1 season2 season3 
budget_grp_new race sex rae_person_new age_cat fqhc bh_oth17 bh_oth18 bh_oth19 bh_er17 bh_er18 
bh_er19 bh_hosp17 bh_hosp18 bh_hosp19 adj_pd_total_17cat adj_pd_total_18cat adj_pd_total_19cat / 
DIST=binomial;
MPRINT(HURDLE):   REPEATED SUBJECT = mcaid_id / type=exch ;
MPRINT(HURDLE):   store out.cost_pc_pmodel_exch;
MPRINT(HURDLE):   output out = predout pred = pred;
MPRINT(HURDLE):   run;

NOTE: Class levels for some variables were not printed due to excessive size.
NOTE: PROC GENMOD is modeling the probability that ind_cost_pc='1'. One way to change this to model 
      the probability that ind_cost_pc='0' is to specify the DESCENDING option in the PROC 
      statement.
NOTE: Algorithm converged.
NOTE: Algorithm converged.
NOTE: The GENMOD procedure generated the model item store OUT.COST_PC_PMODEL_EXCH.
NOTE: The data set WORK.PREDOUT has 19283171 observations and 41 variables.
NOTE: PROCEDURE GENMOD used (Total process time):
      real time           16:24.96
      cpu time            15:40.00
      